<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Geo Browser Tool (Frontend)</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body { font-family: Inter, sans-serif; background:#f4f6f9; color:#111; padding:20px; }
    .card { background:#fff; max-width:800px; margin:auto; padding:20px; border-radius:10px; box-shadow:0 4px 16px rgba(0,0,0,0.1); }
    label { display:block; font-weight:600; margin-top:10px; }
    input[type=url], select { width:100%; padding:10px; border-radius:8px; border:1px solid #ccc; }
    button { margin-top:15px; padding:10px 14px; background:#0ea5e9; color:white; border:none; border-radius:8px; cursor:pointer; font-weight:600; }
    button:hover { background:#0284c7; }
    iframe { width:100%; height:600px; border:1px solid #ddd; border-radius:8px; margin-top:15px; }
    pre { background:#0f172a; color:#fff; padding:12px; border-radius:8px; overflow:auto; max-height:200px; }
  </style>
</head>
<body>
  <div class="card">
    <h2>üåç Geo Browser Tool</h2>
    <p>Paste your target URL, select a proxy location, and view the site through that geo region.</p>

    <label>Target URL</label>
    <input id="urlInput" type="url" placeholder="https://example.com" value="https://pooreyoutuber.github.io" />

    <label>Choose Proxy / Geo Location</label>
    <select id="proxySelect">
      <option>Loading proxies...</option>
    </select>

    <button id="fetchBtn">Open via Selected Proxy</button>

    <h3>Logs</h3>
    <pre id="log">No logs yet...</pre>

    <h3>Result</h3>
    <iframe id="resultFrame" sandbox="allow-same-origin allow-forms allow-popups"></iframe>
  </div>

<script>
function log(msg) {
  const el = document.getElementById('log');
  el.textContent = new Date().toLocaleTimeString() + ' ‚Ä∫ ' + msg + '\n' + el.textContent;
}

async function loadProxies() {
  const res = await fetch('proxies.php');
  const list = await res.json();
  const select = document.getElementById('proxySelect');
  select.innerHTML = '';
  list.forEach((p, i) => {
    const opt = document.createElement('option');
    opt.value = i;
    opt.textContent = p.label;
    select.appendChild(opt);
  });
  log('Loaded ' + list.length + ' proxies.');
}

document.getElementById('fetchBtn').addEventListener('click', async () => {
  const url = document.getElementById('urlInput').value.trim();
  const proxyIndex = document.getElementById('proxySelect').value;

  if (!url) {
    alert('Please enter a valid URL!');
    return;
  }

  log('Fetching ' + url + ' via proxy #' + proxyIndex);

  const res = await fetch('fetch.php', {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({ url, proxyIndex })
  });

  const json = await res.json();
  if (!json.ok) {
    log('‚ùå Error: ' + json.error);
    return;
  }

  log('‚úÖ IP used: ' + (json.ipInfo.ip || 'Unknown'));
  const frame = document.getElementById('resultFrame');
  const doc = frame.contentWindow.document;
  doc.open();
  doc.write(json.content);
  doc.close();
});

loadProxies();
</script>
</body>
</html>
