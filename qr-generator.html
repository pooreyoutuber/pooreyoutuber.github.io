<!DOCTYPE html>
<html lang="en">
<head>
┬а ┬а <meta charset="UTF-8">
┬а ┬а <meta name="viewport" content="width=device-width, initial-scale=1.0">
┬а ┬а <title>GA4 Traffic Injector (FINAL CLOUD FIX)</title>
┬а ┬а <style>
┬а ┬а ┬а ┬а /* Compact UI */
┬а ┬а ┬а ┬а body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; background-color: #f0f4f8; display: flex; justify-content: center; align-items: center; min-height: 100vh; }
┬а ┬а ┬а ┬а .container { width: 90%; max-width: 420px; background: #ffffff; padding: 20px; border-radius: 10px; box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15); }
┬а ┬а ┬а ┬а h2 { color: #dc3545; border-bottom: 2px solid #dc3545; padding-bottom: 6px; margin-top: 0; text-align: center; font-size: 1.4em; }
┬а ┬а ┬а ┬а label { display: block; margin-top: 10px; font-weight: 600; color: #333; font-size: 0.85em; }
┬а ┬а ┬а ┬а input[type="url"], input[type="text"] { width: 100%; padding: 8px; margin-top: 3px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; font-size: 0.85em; }
┬а ┬а ┬а ┬а button { background-color: #28a745; color: white; padding: 10px; border: none; border-radius: 4px; cursor: pointer; width: 100%; margin-top: 15px; font-size: 0.95em; font-weight: bold; transition: background-color 0.3s; }
┬а ┬а ┬а ┬а button:disabled { background-color: #90ee90; cursor: not-allowed; }
┬а ┬а ┬а ┬а #output { margin-top: 12px; padding: 8px; border: 1px solid #ffe8cc; background-color: #fff8e1; border-radius: 4px; max-height: 120px; overflow-y: scroll; font-size: 0.75em; }
┬а ┬а ┬а ┬а #status { padding: 6px; background-color: #dc3545; border-radius: 4px; font-weight: bold; color: white; margin-top: 10px; text-align: center; font-size: 0.85em; }
┬а ┬а ┬а ┬а .disclaimer { font-size: 0.75em; color: #333; margin-top: 8px; padding: 8px; border: 1px solid #d4edda; background-color: #f0fdf2; border-radius: 4px; }
┬а ┬а ┬а ┬а .input-group { margin-bottom: 12px; }
┬а ┬а </style>
</head>
<body>

<div class="container">
┬а ┬а <h2>ЁЯЪи GA4 рдЯреНрд░реИрдлрд┐рдХ (рдЕрдВрддрд┐рдо рдХреНрд▓рд╛рдЙрдб рдлрд┐рдХреНрд╕)</h2>

┬а ┬а <div class="disclaimer">
┬а ┬а ┬а ┬а **рдЕрдВрддрд┐рдо рдкреНрд░рдпрд╛рд╕:** рдЗрд╕ рдХреЛрдб рдореЗрдВ рдПрдХ рдирдП рдкрдмреНрд▓рд┐рдХ рдкреНрд░реЙрдХреНрд╕реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдпрджрд┐ рдпрд╣ рднреА рд╡рд┐рдлрд▓ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдкреБрд╖реНрдЯрд┐ рд╣реЛ рдЬрд╛рдПрдЧреА рдХрд┐ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ рдпрд╣ рдХрд╛рдо рдирд╣реАрдВ рдХрд░реЗрдЧрд╛ред рдкрд░рд┐рдгрд╛рдо рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП **Admin -> DebugView** рдЦреЛрд▓реЗрдВред
┬а ┬а </div>

┬а ┬а <div class="input-group">
┬а ┬а ┬а ┬а <label for="measurementIdInput">GA4 ID (G-XXXXXXX):</label>
┬а ┬а ┬а ┬а <input type="text" id="measurementIdInput" placeholder="G-XXXXXXXXXX" required>
┬а ┬а </div>
┬а ┬а┬а
┬а ┬а <div class="input-group">
┬а ┬а ┬а ┬а <label for="apiSecretInput">API Secret:</label>
┬а ┬а ┬а ┬а <input type="text" id="apiSecretInput" placeholder="рдЖрдкрдХрд╛_API_рд╕реАрдХреНрд░реЗрдЯ" required>
┬а ┬а </div>

┬а ┬а <div class="input-group">
┬а ┬а ┬а ┬а <label for="urlInput">рд╡реЗрдмрд╕рд╛рдЗрдЯ URL (https://):</label>
┬а ┬а ┬а ┬а <input type="url" id="urlInput" placeholder="https://your-project.com" required>
┬а ┬а </div>
┬а ┬а┬а
┬а ┬а <div id="status">Status: Ready | Target: 100 Views</div>

┬а ┬а <button id="startButton" onclick="startSimulation()">Start Simulation</button>
┬а ┬а┬а
┬а ┬а <label>рдЖрдЙрдЯрдкреБрдЯ рд▓реЙрдЧ:</label>
┬а ┬а <div id="output"></div>
</div>

<script>
┬а ┬а let totalViews = 100;
┬а ┬а let successfulViews = 0;
┬а ┬а let viewCount = 0;
┬а ┬а let isRunning = false;
┬а ┬а let simulationTimeout;
┬а ┬а const MIN_DELAY = 1500;
┬а ┬а const MAX_DELAY = 4000;
┬а ┬а┬а
┬а ┬а // FIX: рдПрдХ рдЕрд▓рдЧ, рдФрд░ рдЕрдзрд┐рдХ рднрд░реЛрд╕реЗрдордВрдж (рдЙрдореНрдореАрдж рд╣реИ) рдкреНрд░реЙрдХреНрд╕реА URL
┬а ┬а const PROXY_URL = 'https://cors-anywhere.herokuapp.com/';┬а
┬а ┬а // рдиреЛрдЯ: рдпрд╣ рдкреНрд░реЙрдХреНрд╕реА рднреА рдХрднреА рднреА рдХрд╛рдо рдХрд░рдирд╛ рдмрдВрдж рдХрд░ рд╕рдХрддрд╛ рд╣реИред

┬а ┬а // User Agents рдХреА рд╕реВрдЪреА (рдорд▓реНрдЯреА-рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╕рд┐рдореБрд▓реЗрд╢рди рдХреЗ рд▓рд┐рдП)
┬а ┬а const userAgents = [
┬а ┬а ┬а ┬а "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",
┬а ┬а ┬а ┬а "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.0 Safari/605.1.15",
┬а ┬а ┬а ┬а "Mozilla/5.0 (Linux; Android 14; Pixel 8) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Mobile Safari/537.36",
┬а ┬а ];

┬а ┬а function getRandomDelay() {
┬а ┬а ┬а ┬а return Math.random() * (MAX_DELAY - MIN_DELAY) + MIN_DELAY;┬а
┬а ┬а }
┬а ┬а┬а
┬а ┬а function getRandomUserAgent() {
┬а ┬а ┬а ┬а return userAgents[Math.floor(Math.random() * userAgents.length)];
┬а ┬а }

┬а ┬а const outputDiv = document.getElementById('output');
┬а ┬а const statusDiv = document.getElementById('status');
┬а ┬а const startButton = document.getElementById('startButton');

┬а ┬а function log(message, type = 'info') {
┬а ┬а ┬а ┬а const p = document.createElement('p');
┬а ┬а ┬а ┬а p.innerHTML = message;
┬а ┬а ┬а ┬а if (type === 'error') p.style.color = '#dc3545';
┬а ┬а ┬а ┬а if (type === 'success') p.style.color = '#28a745';
┬а ┬а ┬а ┬а outputDiv.prepend(p);
┬а ┬а }
┬а ┬а┬а
┬а ┬а // POST Request рдХреЗ рд╕рд╛рде рдкреНрд░реЙрдХреНрд╕реА рдХрд╛ рдЙрдкрдпреЛрдЧ
┬а ┬а async function sendData(gaEndpointUrl, payload, currentViewId, userAgent) {
┬а ┬а ┬а ┬а┬а
┬а ┬а ┬а ┬а // FIX: рдкреНрд░реЙрдХреНрд╕реА URL рдХреЛ GA4 рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХреЗ рд╕рд╛рде рдЬреЛрдбрд╝реЗрдВ
┬а ┬а ┬а ┬а const proxiedUrl = PROXY_URL + gaEndpointUrl;

┬а ┬а ┬а ┬а try {
┬а ┬а ┬а ┬а ┬а ┬а const response = await fetch(proxiedUrl, {
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а method: 'POST',
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а body: JSON.stringify(payload),
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а headers: {┬а
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а 'Content-Type': 'application/json',
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а // User Agent рдХреЛ рд╣реЗрдбрд░ рдХреЗ рд░реВрдк рдореЗрдВ рднреЗрдЬреЗрдВ (POST рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ)
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а 'User-Agent': userAgent,┬а
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а // CORS-Anywhere рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реЗрдбрд░
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а 'X-Requested-With': 'XMLHttpRequest'┬а
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а }
┬а ┬а ┬а ┬а ┬а ┬а });

┬а ┬а ┬а ┬а ┬а ┬а // GA4 204 No Content рд▓реМрдЯрд╛рддрд╛ рд╣реИ рдпрджрд┐ рд╕рдлрд▓ рд╣реЛ
┬а ┬а ┬а ┬а ┬а ┬а if (response.status === 204) {┬а
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а successfulViews++;
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а log(`View ${currentViewId}: <span style="font-weight:bold;">SUCCESS</span> | Device: ${userAgent.split('(')[1].split(')')[0]}`, 'success');
┬а ┬а ┬а ┬а ┬а ┬а } else {
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а// рдЕрдЧрд░ рдкреНрд░реЙрдХреНрд╕реА рдпрд╛ GA4 рдиреЗ рдПрд░рд░ рджреА
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а const errorText = await response.text();
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а log(`View ${currentViewId}: <span style="font-weight:bold;">FAILURE</span> | Status: ${response.status}. GA4 did not accept data.`, 'error');
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а log(`DEBUG: Response Text (First 100 chars): ${errorText.substring(0, 100)}...`, 'error');
┬а ┬а ┬а ┬а ┬а ┬а }
┬а ┬а ┬а ┬а ┬а ┬а┬а
┬а ┬а ┬а ┬а } catch (error) {
┬а ┬а ┬а ┬а ┬а ┬а log(`View ${currentViewId}: <span style="font-weight:bold;">ERROR</span> | Connection/Proxy Failed. ${error.message}`, 'error');
┬а ┬а ┬а ┬а } finally {
┬а ┬а ┬а ┬а ┬а ┬а statusDiv.innerHTML = `Running... Attempts: <b>${currentViewId}</b> of <b>${totalViews}</b> | Successful: ${successfulViews}`;
┬а ┬а ┬а ┬а }
┬а ┬а }

┬а ┬а // рдореБрдЦреНрдп рд╡реНрдпреВ рдЬрдирд░реЗрдЯ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдлрд╝рдВрдХреНрд╢рди (рдкреБрд░рд╛рдиреЗ рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рдХреЗ рд╕рд╛рде)
┬а ┬а function generateView(url, measurementId, apiSecret) {
┬а ┬а ┬а ┬а if (!isRunning || viewCount >= totalViews) {
┬а ┬а ┬а ┬а ┬а ┬а finishSimulation();
┬а ┬а ┬а ┬а ┬а ┬а return;
┬а ┬а ┬а ┬а }

┬а ┬а ┬а ┬а viewCount++;
┬а ┬а ┬а ┬а const currentViewId = viewCount;
┬а ┬а ┬а ┬а┬а
┬а ┬а ┬а ┬а const CLIENT_ID = Math.random().toString(36).substring(2, 12) + Date.now().toString(36);
┬а ┬а ┬а ┬а const SESSION_ID = Date.now();┬а
┬а ┬а ┬а ┬а const USER_AGENT = getRandomUserAgent();┬а
┬а ┬а ┬а ┬а const gaEndpoint = `https://www.google-analytics.com/mp/collect?measurement_id=${measurementId}&api_secret=${apiSecret}`;

┬а ┬а ┬а ┬а // 1. Session Start Event
┬а ┬а ┬а ┬а const sessionStartPayload = {
┬а ┬а ┬а ┬а ┬а ┬а client_id: CLIENT_ID,
┬а ┬а ┬а ┬а ┬а ┬а events: [{
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а name: 'session_start',┬а
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а params: {
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а debug_mode: true,┬а
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а session_id: SESSION_ID,
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а _ss: 1┬а
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а }
┬а ┬а ┬а ┬а ┬а ┬а }]
┬а ┬а ┬а ┬а };
┬а ┬а ┬а ┬а sendData(gaEndpoint, sessionStartPayload, currentViewId, USER_AGENT);

┬а ┬а ┬а ┬а // 2. Page View Event
┬а ┬а ┬а ┬а const engagementTime = 10000 + Math.floor(Math.random() * 10000);┬а

┬а ┬а ┬а ┬а const pageViewPayload = {
┬а ┬а ┬а ┬а ┬а ┬а client_id: CLIENT_ID,
┬а ┬а ┬а ┬а ┬а ┬а events: [{
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а name: 'page_view',┬а
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а params: {
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а page_location: url, // Standard MP parameter
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а page_title: `PROJECT_VIEW_${currentViewId}`, // Standard MP parameter
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а debug_mode: true,┬а
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а session_id: SESSION_ID,┬а
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а engagement_time_msec: engagementTime,┬а
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а }
┬а ┬а ┬а ┬а ┬а ┬а }]
┬а ┬а ┬а ┬а };
┬а ┬а ┬а ┬а┬а
┬а ┬а ┬а ┬а setTimeout(() => {
┬а ┬а ┬а ┬а ┬а ┬а sendData(gaEndpoint, pageViewPayload, currentViewId, USER_AGENT);
┬а ┬а ┬а ┬а ┬а ┬а scheduleNextView(url, measurementId, apiSecret);
┬а ┬а ┬а ┬а }, 500);┬а

┬а ┬а }


┬а ┬а function scheduleNextView(url, measurementId, apiSecret) {
┬а ┬а ┬а ┬а if (viewCount < totalViews && isRunning) {
┬а ┬а ┬а ┬а ┬а ┬а const delay = getRandomDelay();
┬а ┬а ┬а ┬а ┬а ┬а simulationTimeout = setTimeout(() => generateView(url, measurementId, apiSecret), delay);
┬а ┬а ┬а ┬а } else {
┬а ┬а ┬а ┬а ┬а ┬а finishSimulation();
┬а ┬а ┬а ┬а }
┬а ┬а }

┬а ┬а function startSimulation() {
┬а ┬а ┬а ┬а const url = document.getElementById('urlInput').value.trim();
┬а ┬а ┬а ┬а const measurementId = document.getElementById('measurementIdInput').value.trim();
┬а ┬а ┬а ┬а const apiSecret = document.getElementById('apiSecretInput').value.trim();

┬а ┬а ┬а ┬а if (!url.startsWith('http')) {
┬а ┬а ┬а ┬а ┬а ┬а alert("рдХреГрдкрдпрд╛ URL 'https://' рдпрд╛ 'http://' рд╕реЗ рд╢реБрд░реВ рдХрд░реЗрдВред");
┬а ┬а ┬а ┬а ┬а ┬а return;
┬а ┬а ┬а ┬а }
┬а ┬а ┬а ┬а if (!measurementId.startsWith('G-')) {
┬а ┬а ┬а ┬а ┬а ┬а alert("рдХреГрдкрдпрд╛ рд╕рд╣реА GA4 ID (G- рд╕реЗ рд╢реБрд░реВ рд╣реЛрдиреЗ рд╡рд╛рд▓реА) рджрд░реНрдЬ рдХрд░реЗрдВред");
┬а ┬а ┬а ┬а ┬а ┬а return;
┬а ┬а ┬а ┬а }
┬а ┬а ┬а ┬а if (apiSecret.length < 5) {
┬а ┬а ┬а ┬а ┬а ┬а alert("рдХреГрдкрдпрд╛ рд╕рд╣реА API Secret рджрд░реНрдЬ рдХрд░реЗрдВред");
┬а ┬а ┬а ┬а ┬а ┬а return;
┬а ┬а ┬а ┬а }
┬а ┬а ┬а ┬а if (isRunning) return;

┬а ┬а ┬а ┬а isRunning = true;
┬а ┬а ┬а ┬а startButton.disabled = true;
┬а ┬а ┬а ┬а startButton.textContent = "Simulation Running... (DO NOT CLOSE TAB)";
┬а ┬а ┬а ┬а┬а
┬а ┬а ┬а ┬а successfulViews = 0;
┬а ┬а ┬а ┬а viewCount = 0;
┬а ┬а ┬а ┬а outputDiv.innerHTML = '';┬а
┬а ┬а ┬а ┬а┬а
┬а ┬а ┬а ┬а log(`ЁЯЪА Simulation Started. Target: ${totalViews} Views.`, 'info');
┬а ┬а ┬а ┬а statusDiv.innerHTML = "Starting requests...";

┬а ┬а ┬а ┬а generateView(url, measurementId, apiSecret);
┬а ┬а }

┬а ┬а function finishSimulation() {
┬а ┬а ┬а ┬а clearTimeout(simulationTimeout);
┬а ┬а ┬а ┬а if (!isRunning) return;
┬а ┬а ┬а ┬а┬а
┬а ┬а ┬а ┬а log("<hr>", 'info');
┬а ┬а ┬а ┬а log(`тЬЕ **Simulation Complete!**`, 'info');
┬а ┬а ┬а ┬а log(`Final Successful Views: <b>${successfulViews}</b>`, 'info');
┬а ┬а ┬а ┬а log("<hr>", 'info');
┬а ┬а ┬а ┬а┬а
┬а ┬а ┬а ┬а startButton.disabled = false;
┬а ┬а ┬а ┬а startButton.textContent = "Start Simulation";
┬а ┬а ┬а ┬а isRunning = false;
┬а ┬а ┬а ┬а statusDiv.innerHTML = `Finished. Total Views: ${successfulViews}`;
┬а ┬а }
</script>

</body>
</html> 
