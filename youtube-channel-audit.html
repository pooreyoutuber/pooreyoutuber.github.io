<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>YouTube Audit Tool</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      background: #0f172a;
      color: #e2e8f0;
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    h1 { font-size: 24px; margin-bottom: 10px; }
    .input-group { margin: 20px 0; display: flex; gap: 10px; }
    input, button {
      padding: 10px;
      font-size: 16px;
    }
    input { flex: 1; border: none; border-radius: 6px; }
    button {
      background: #38bdf8;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    .card {
      background: #1e293b;
      padding: 16px;
      margin: 10px 0;
      border-radius: 10px;
    }
    .channel-header { display: flex; gap: 16px; }
    .channel-thumb img {
      width: 96px;
      height: 96px;
      border-radius: 12px;
    }
    .video-list { margin-top: 10px; }
    .video-item {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 8px;
    }
    .video-item img {
      width: 160px;
      height: 90px;
      border-radius: 6px;
    }
    .rec {
      background: rgba(255, 255, 255, 0.05);
      padding: 8px;
      border-radius: 6px;
      margin-top: 6px;
    }
    a { color: #38bdf8; text-decoration: none; }
    .badge {
      display: inline-block;
      background: #334155;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 12px;
      margin-left: 8px;
    }
  </style>
</head>
<body>

  <h1>YouTube Audit Tool</h1>
  <p>Paste any YouTube channel URL, handle, or video link to get an SEO + UX audit.</p>

  <div class="input-group">
    <input id="input" placeholder="e.g. https://youtube.com/@YourChannel" />
    <button onclick="startAudit()">Audit</button>
  </div>

  <div id="result"></div>

  <script>
    const API_KEY = "AIzaSyAI7S6lmMnAwDn0jTje_d1w_Qd9gQH_fAo"; // ‚ö†Ô∏è Your API Key

    async function startAudit() {
      const input = document.getElementById('input').value.trim();
      if (!input) return alert("Please enter a YouTube channel URL or handle.");
      document.getElementById('result').innerHTML = '<div class="card">Loading...</div>';

      try {
        const channelId = await resolveChannelId(input);
        const channelInfo = await getChannelInfo(channelId);
        const videos = await getChannelVideos(channelInfo.uploads);
        const topVideos = videos.sort((a, b) => b.views - a.views).slice(0, 10);
        const recommendations = generateTips(channelInfo, topVideos);

        renderResults(channelInfo, topVideos, recommendations);
      } catch (err) {
        document.getElementById('result').innerHTML = `<div class="card">‚ùå ${err.message}</div>`;
      }
    }

    async function resolveChannelId(input) {
      const handleMatch = input.match(/@([a-zA-Z0-9_-]+)/);
      if (handleMatch) {
        const q = encodeURIComponent('@' + handleMatch[1]);
        const url = `https://www.googleapis.com/youtube/v3/search?part=snippet&type=channel&q=${q}&key=${API_KEY}`;
        const res = await fetch(url);
        const data = await res.json();
        if (!data.items.length) throw new Error("Channel not found");
        return data.items[0].snippet.channelId;
      }

      const idMatch = input.match(/channel\/([a-zA-Z0-9_-]+)/);
      if (idMatch) return idMatch[1];

      const videoMatch = input.match(/v=([a-zA-Z0-9_-]+)/);
      if (videoMatch) {
        const vid = videoMatch[1];
        const url = `https://www.googleapis.com/youtube/v3/videos?part=snippet&id=${vid}&key=${API_KEY}`;
        const res = await fetch(url);
        const data = await res.json();
        return data.items[0].snippet.channelId;
      }

      throw new Error("Unsupported input format");
    }

    async function getChannelInfo(channelId) {
      const url = `https://www.googleapis.com/youtube/v3/channels?part=snippet,statistics,contentDetails&id=${channelId}&key=${API_KEY}`;
      const res = await fetch(url);
      const data = await res.json();
      const ch = data.items[0];
      return {
        id: ch.id,
        title: ch.snippet.title,
        desc: ch.snippet.description,
        thumb: ch.snippet.thumbnails.high.url,
        subs: ch.statistics.subscriberCount,
        views: ch.statistics.viewCount,
        uploads: ch.contentDetails.relatedPlaylists.uploads
      };
    }

    async function getChannelVideos(playlistId) {
      let videos = [];
      let nextPage = '';
      while (videos.length < 50) {
        const url = `https://www.googleapis.com/youtube/v3/playlistItems?part=snippet,contentDetails&maxResults=50&playlistId=${playlistId}&key=${API_KEY}&pageToken=${nextPage}`;
        const res = await fetch(url);
        const data = await res.json();
        const ids = data.items.map(i => i.contentDetails.videoId).join(',');
        const detailsUrl = `https://www.googleapis.com/youtube/v3/videos?part=snippet,statistics&id=${ids}&key=${API_KEY}`;
        const detailsRes = await fetch(detailsUrl);
        const detailData = await detailsRes.json();

        detailData.items.forEach(v => {
          videos.push({
            id: v.id,
            title: v.snippet.title,
            views: +v.statistics.viewCount || 0,
            published: v.snippet.publishedAt,
            thumb: v.snippet.thumbnails.medium.url,
            tags: v.snippet.tags || [],
            desc: v.snippet.description || ''
          });
        });

        if (!data.nextPageToken) break;
        nextPage = data.nextPageToken;
      }
      return videos;
    }

    function generateTips(channel, topVideos) {
      const tips = [];

      if (!channel.desc || channel.desc.length < 50) {
        tips.push("üîç Add a detailed channel description with keywords (50‚Äì300 characters).");
      }

      if (topVideos.length === 0) {
        tips.push("üì≠ No public videos found.");
        return tips;
      }

      topVideos.forEach(v => {
        if (v.title.length < 20) tips.push(`‚úèÔ∏è Short title: "${v.title}" ‚Äî make it more descriptive.`);
        if (v.desc.length < 100) tips.push(`üìÑ Short description in "${v.title}" ‚Äî write 1‚Äì2 lines with keywords.`);
        if (v.tags.length === 0) tips.push(`üè∑Ô∏è No tags in "${v.title}" ‚Äî add 5‚Äì10 relevant tags.`);
      });

      tips.push("üé® Improve thumbnails with clear text and contrast.");
      tips.push("üîó Use end screens and pinned comments to increase engagement.");
      tips.push("üß© Use chapters (timestamps) for long videos to boost retention.");
      return tips;
    }

    function renderResults(channel, topVideos, tips) {
      let html = `
        <div class="card channel-header">
          <div class="channel-thumb"><img src="${channel.thumb}" /></div>
          <div>
            <h2>${channel.title}</h2>
            <div>${channel.desc?.slice(0, 150) || 'No description'}...</div>
            <div>Subscribers: ${formatNum(channel.subs)} | Views: ${formatNum(channel.views)}</div>
          </div>
        </div>
        <div class="card">
          <h3>üìà Top 10 Videos</h3>
          <div class="video-list">
      `;
      topVideos.forEach(v => {
        html += `
          <div class="video-item">
            <img src="${v.thumb}" />
            <div>
              <a href="https://youtube.com/watch?v=${v.id}" target="_blank">${
