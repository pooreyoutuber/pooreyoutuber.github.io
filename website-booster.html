<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Website Traffic Booster Pro</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <style>
        :root {
            --primary-color: #007bff; /* Blue */
            --secondary-color: #6c757d; /* Gray */
            --success-color: #28a745;
            --danger-color: #dc3545;
            --warning-color: #ffc107;
            --bg-color: #f4f7f9;
            --card-bg: #ffffff;
            --text-color: #343a40;
            --border-color: #e9ecef;
            --shadow: 0 0.5rem 1rem rgba(0,0,0,.05);
        }

        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg-color); color: var(--text-color); margin: 0; padding: 0; }
        .container { max-width: 900px; margin: 40px auto; padding: 20px; }
        
        .card { background: var(--card-bg); border-radius: 8px; box-shadow: var(--shadow); padding: 30px; margin-bottom: 20px; }
        
        h1 { color: var(--primary-color); text-align: center; margin-bottom: 5px; font-weight: 600; font-size: 2em; }
        .subtitle { text-align: center; color: var(--secondary-color); margin-bottom: 30px; font-size: 1.1em; }

        .form-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 5px; font-weight: 500; }
        input[type="url"], input[type="number"], .status-box { 
            width: 100%; padding: 12px 15px; border: 1px solid var(--border-color); border-radius: 6px; 
            font-size: 16px; box-sizing: border-box; transition: border-color 0.2s; 
        }
        input:focus { border-color: var(--primary-color); outline: none; }

        .input-group-btn { display: flex; gap: 10px; margin-top: 20px; }
        .btn { padding: 12px 25px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 16px; transition: background-color 0.2s, opacity 0.2s; }
        .btn-start { background-color: var(--success-color); color: white; flex-grow: 1; }
        .btn-stop { background-color: var(--danger-color); color: white; width: 120px; }
        .btn:disabled { opacity: 0.6; cursor: not-allowed; }

        /* API Status Box */
        #apiStatus { padding: 15px; margin-bottom: 25px; border-radius: 6px; font-weight: 500; text-align: center; }
        .status-loading { background-color: #f7e8c3; color: var(--warning-color); border: 1px solid #ffeb3c; }
        .status-success { background-color: #d4edda; color: #155724; border: 1px solid var(--success-color); }
        .status-error { background-color: #f8d7da; color: #721c24; border: 1px solid var(--danger-color); }

        /* Log Area */
        .log-area { margin-top: 30px; }
        .log-area h2 { font-size: 1.2em; margin-bottom: 10px; color: var(--text-color); border-bottom: 2px solid var(--border-color); padding-bottom: 5px; }
        #server-log { white-space: pre-wrap; font-family: monospace; font-size: 12px; min-height: 180px; max-height: 300px; background: #f8f8f8; padding: 15px; border-radius: 4px; overflow-y: auto; border: 1px solid #ccc; }
        
        /* Slots Display - Simplified for Server-Side */
        .slots-info { margin-top: 20px; text-align: center; color: var(--primary-color); font-weight: 600; }
        
        .description-box { margin-top: 30px; padding: 20px; background-color: #e9f7ff; border: 1px solid #bce8f1; border-radius: 6px; color: #31708f; }
        .description-box h3 { margin-top: 0; color: var(--primary-color); }
        .description-box p { margin-bottom: 0; line-height: 1.6; }
    </style>
</head>
<body>
    <div class="container">
        <div class="card">
            <h1>üåê Website Traffic Booster Pro (Server-Side)</h1>
            <p class="subtitle">Generate genuine multi-country traffic using premium proxies.</p>
            
            <div id="apiStatus" class="status-loading">
                <i class="fas fa-sync-alt fa-spin"></i> Connecting to API server...
            </div>

            <div class="form-group">
                <label for="targetUrl"><i class="fas fa-link"></i> Target Website URL (Required)</label>
                <input type="url" id="targetUrl" placeholder="Enter full URL (e.g., https://yourwebsite.com)" required>
            </div>

            <div class="form-group">
                <label for="totalViews"><i class="fas fa-eye"></i> Total Views Goal (Optional - For tracking only)</label>
                <input type="number" id="totalViews" placeholder="e.g., 500 (Set a goal; actual views depend on runtime)" min="1">
            </div>

            <div class="input-group-btn">
                <button id="startBtn" class="btn btn-start" disabled><i class="fas fa-play-circle"></i> START TRAFFIC (2 Slots)</button>
                <button id="stopBtn" class="btn btn-stop" disabled><i class="fas fa-stop-circle"></i> STOP</button>
            </div>

            <div class="slots-info" id="slotStatus">
                Current Active Sessions: 0 / Max Server Capacity: 20
            </div>
            
            <div class="log-area">
                <h2><i class="fas fa-chart-line"></i> Server Activity Log</h2>
                <pre id="server-log">Server logs will show successful proxy connections and view cycles...</pre>
            </div>

            <div class="description-box">
                <h3>Important Notice:</h3>
                <p>
                    Your traffic is generated using **unique proxies** and **user agents** from various countries to simulate real user behavior. 
                    **Please check your Google Analytics/YouTube Studio report after 24 hours** for accurate data and country-specific view increase. 
                    The tool runs continuously until you press STOP or the server limit is reached.
                </p>
            </div>
        </div>
    </div>

    <script>
        // --- Configuration ---
        const API_BASE_URL = "https://pooreyoutuber-github-io.onrender.com/api/booster"; 
        
        // --- Elements ---
        const statusElement = document.getElementById('apiStatus');
        const startBtn = document.getElementById('startBtn');
        const stopBtn = document.getElementById('stopBtn');
        const targetUrlInput = document.getElementById('targetUrl');
        const serverLog = document.getElementById('server-log');
        const slotStatus = document.getElementById('slotStatus');

        // --- Utility Functions ---
        function updateStatus(message, type) {
            statusElement.innerHTML = message;
            statusElement.className = ''; 
            statusElement.classList.add('status-' + type);
        }
        
        function updateSlotInfo(active, max) {
             slotStatus.innerHTML = `Current Active Sessions: ${active} / Max Server Capacity: ${max}`;
        }
        
        function appendLog(message, isError = false) {
            const now = new Date().toLocaleTimeString();
            let color = isError ? 'var(--danger-color)' : 'var(--success-color)';
            let icon = isError ? '&#9888;' : '&#10003;'; // Warning/Check Mark
            
            // Only update log for successful starts/stops/errors to keep it clean
            if (!isError && message.includes('Starting')) color = 'var(--primary-color)';
            if (message.includes('Stopped')) color = 'var(--secondary-color)';

            serverLog.innerHTML += `<span style="color: ${color}; font-weight: bold;">[${now} ${icon}]</span> ${message}\n`;
            serverLog.scrollTop = serverLog.scrollHeight; 
        }

        // --- API Calls ---
        async function fetchConfig() {
            updateStatus(`<i class="fas fa-sync-alt fa-spin"></i> Connecting to API server...`, 'loading');
            try {
                const response = await fetch(`${API_BASE_URL}/config`);
                
                if (response.status === 503) throw new Error("Server is sleeping. Wait 15s and refresh.");
                
                const data = await response.json();

                if (response.ok && data.status === 'success') {
                    updateStatus(`‚úÖ Config Loaded. Slots per User: ${data.slotsPerUser}. Total Proxies: ${data.proxyCount}.`, 'success');
                    updateSlotInfo(0, data.maxSlots);
                    startBtn.disabled = false;
                } else {
                    throw new Error(data.message || 'Failed to load configuration.');
                }
            } catch (error) {
                updateStatus(`‚ùå Network Error: ${error.message}`, 'error');
            }
        }
        
        async function handleStart() {
            const url = targetUrlInput.value.trim();

            if (!url || !url.startsWith('http')) { 
                alert("Please enter a valid URL starting with http:// or https://"); 
                return; 
            }

            startBtn.disabled = true;
            stopBtn.disabled = false;
            updateStatus(`<i class="fas fa-rocket fa-spin"></i> Sending START command to Server...`, 'loading');
            
            try {
                const response = await fetch(`${API_BASE_URL}/start-traffic`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ url }) 
                });

                const result = await response.json();
                
                updateSlotInfo(result.slotsRunning, result.maxSlots);

                if (response.ok && result.status === 'success') {
                    updateStatus(`‚úÖ Traffic Started Successfully! Running ${result.slotCount} continuous sessions.`, 'success');
                    appendLog(`Starting traffic on ${result.slotCount} slots for URL: ${new URL(url).hostname}.`, false);
                } else if (response.status === 400) {
                     updateStatus(`‚ö†Ô∏è Start Warning: ${result.message}`, 'warning');
                     appendLog(`Warning: ${result.message}`, true);
                     stopBtn.disabled = true;
                     startBtn.disabled = false;
                } else {
                    throw new Error(result.message || 'Server failed to start traffic.');
                }
            } catch (error) {
                updateStatus(`‚ùå Start Error: ${error.message.substring(0, 70)}...`, 'error');
                appendLog(`Error starting traffic: ${error.message}`, true);
                startBtn.disabled = false;
                stopBtn.disabled = true;
            }
        }

        async function handleStop() {
            startBtn.disabled = true;
            stopBtn.disabled = true;
            updateStatus(`<i class="fas fa-hourglass-half"></i> Sending STOP command...`, 'loading');
            appendLog(`Command sent: Stopping your session.`, false);

            try {
                const response = await fetch(`${API_BASE_URL}/stop-traffic`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                });

                const result = await response.json();
                updateSlotInfo(result.slotsRunning, result.maxSlots);

                if (response.ok && result.status === 'success') {
                    updateStatus(`‚è∏Ô∏è Traffic Stopped. Server is idle for your session.`, 'success');
                    appendLog(`Session stopped. Total active slots on server: ${result.slotsRunning}.`, false);
                } else {
                    throw new Error(result.message || 'Server failed to stop traffic.');
                }
            } catch (error) {
                updateStatus(`‚ùå Stop Error: ${error.message.substring(0, 70)}...`, 'error');
                appendLog(`Error stopping: ${error.message}`, true);
            } finally {
                 startBtn.disabled = false;
            }
        }
        
        // --- Event Listeners and Init ---
        startBtn.addEventListener('click', handleStart);
        stopBtn.addEventListener('click', handleStop);
        document.addEventListener('DOMContentLoaded', fetchConfig);
    </script>
</body>
</html>
