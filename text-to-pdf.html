<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pro Image to PDF Converter & Editor | PooreYouTuber Tools</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.6.1/cropper.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.6.1/cropper.min.js"></script>
    
    <style>
        /* ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤‡§ø‡§Ç‡§ó */
        body { font-family: Arial, sans-serif; background-color: #f4f4f9; padding: 20px; }
        .container { max-width: 1100px; margin: 0 auto; background: #fff; padding: 30px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h1 { color: #333; text-align: center; margin-bottom: 30px; }
        
        .upload-section { margin-bottom: 30px; padding: 20px; border: 2px dashed #007bff; border-radius: 8px; text-align: center; }
        
        /* ‡§á‡§Æ‡•á‡§ú ‡§≤‡§ø‡§∏‡•ç‡§ü ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤‡§ø‡§Ç‡§ó */
        .image-list { display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; margin-top: 20px; }
        .image-card { 
            position: relative; 
            border: 1px solid #ddd; 
            padding: 10px; 
            border-radius: 8px; 
            width: 240px; 
            background: #f9f9f9;
        }
        .image-card img { 
            width: 100%; 
            height: 150px; /* ‡§´‡§ø‡§ï‡•ç‡§∏‡•ç‡§° ‡§π‡§æ‡§á‡§ü */
            object-fit: contain; 
            display: block; 
            margin-bottom: 10px; 
            border-radius: 4px;
        }
        .edit-controls { 
            display: flex; 
            flex-wrap: wrap; 
            gap: 5px; 
            margin-top: 10px; 
            justify-content: space-between;
        }
        
        /* ‡§¨‡§ü‡§® ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤‡§ø‡§Ç‡§ó */
        .button { background-color: #007bff; color: white; padding: 8px 12px; border: none; border-radius: 5px; cursor: pointer; font-size: 14px; transition: background-color 0.3s; }
        .button:hover { background-color: #0056b3; }
        .convert-button { width: 100%; margin-top: 30px; padding: 15px; font-size: 18px; background-color: #28a745; }
        .convert-button:hover { background-color: #1e7e34; }
        
        .delete-btn { background-color: #dc3545; }
        .delete-btn:hover { background-color: #c82333; }
        
        .filter-select { width: 100%; padding: 6px; border-radius: 4px; margin-top: 5px; }

        /* ‡§ï‡•ç‡§∞‡•â‡§™‡§ø‡§Ç‡§ó Modal ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤ */
        .modal { display: none; position: fixed; z-index: 100; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.9); }
        .modal-content { background-color: #fefefe; margin: 5% auto; padding: 20px; border: 1px solid #888; width: 90%; max-width: 800px; border-radius: 8px; }
        .close { color: #aaa; float: right; font-size: 28px; font-weight: bold; }
        .close:hover, .close:focus { color: #fff; text-decoration: none; cursor: pointer; }
        #crop-image-container { max-height: 50vh; margin-bottom: 20px; }
        #crop-image { max-width: 100%; display: block; }
        .cropper-view-box { border-radius: 0 !important; } /* Cropper.js ‡§ï‡•á ‡§≤‡§ø‡§è */
    </style>
</head>
<body>
    <div class="container">
        <h1>üìë ‡§á‡§Æ‡•á‡§ú-‡§ü‡•Ç-PDF ‡§ï‡§®‡§µ‡§∞‡•ç‡§ü‡§∞ ‡§î‡§∞ ‡§™‡•ç‡§∞‡•ã ‡§è‡§°‡§ø‡§ü‡§∞</h1>
        <p>‡§Ö‡§™‡§®‡•Ä ‡§á‡§Æ‡•á‡§ú ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç, ‡§ï‡•ç‡§∞‡•â‡§™ ‡§ï‡§∞‡•á‡§Ç, ‡§´‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§≤‡§ó‡§æ‡§è‡§Å ‡§î‡§∞ ‡§è‡§ï ‡§∏‡§ø‡§Ç‡§ó‡§≤ PDF ‡§´‡§º‡§æ‡§á‡§≤ ‡§Æ‡•á‡§Ç ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç‡•§</p>
        
        <div class="upload-section">
            <input type="file" id="image-upload" accept="image/*" multiple>
        </div>

        <div class="image-list" id="image-list">
            </div>

        <button class="button convert-button" onclick="convertToPDF()">‡§∏‡§≠‡•Ä ‡§è‡§°‡§ø‡§ü‡•á‡§° ‡§á‡§Æ‡•á‡§ú ‡§ï‡•ã PDF ‡§Æ‡•á‡§Ç ‡§ï‡§®‡•ç‡§µ‡§∞‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç</button>
    </div>

    <div id="crop-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2>‡§á‡§Æ‡•á‡§ú ‡§ï‡•ç‡§∞‡•â‡§™ ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§è‡§°‡§ø‡§ü ‡§ï‡§∞‡•á‡§Ç</h2>
            <div id="crop-image-container">
                <img id="crop-image" alt="‡§ï‡•ç‡§∞‡•â‡§™ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§á‡§Æ‡•á‡§ú">
            </div>
            <button class="button convert-button" style="width:auto; float:right;" onclick="applyCropAndFilter()">‡§ï‡•ç‡§∞‡•â‡§™ ‡§î‡§∞ ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§≤‡§æ‡§ó‡•Ç ‡§ï‡§∞‡•á‡§Ç</button>
            
            <label for="modal-filter-select" style="font-weight: normal;">‡§ï‡§≤‡§∞ ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞:</label>
            <select id="modal-filter-select" class="filter-select" style="width: 200px;">
                <option value="original">Original</option>
                <option value="grayscale">Black & White (Grayscale)</option>
                <option value="sepia">Soft Tone (Sepia)</option>
                <option value="vibrant">Vibrant (Saturation)</option>
            </select>
        </div>
    </div>

    <script>
        const { jsPDF } = window.jspdf;
        const imageList = document.getElementById('image-list');
        const imageUpload = document.getElementById('image-upload');
        const cropModal = document.getElementById('crop-modal');
        const cropImage = document.getElementById('crop-image');
        const modalFilterSelect = document.getElementById('modal-filter-select');

        let imagesData = [];
        let cropperInstance = null;
        let currentImageId = null;

        // 1. ‡§Æ‡§≤‡•ç‡§ü‡•Ä‡§™‡§≤ ‡§á‡§Æ‡•á‡§ú ‡§ï‡•ã ‡§π‡•à‡§Ç‡§°‡§≤ ‡§ï‡§∞‡§®‡§æ
        imageUpload.addEventListener('change', (event) => {
            const files = event.target.files;
            Array.from(files).forEach(file => {
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        addImageCard(e.target.result);
                    };
                    reader.readAsDataURL(file);
                }
            });
            imageUpload.value = '';
        });

        // 2. ‡§á‡§Æ‡•á‡§ú ‡§≤‡§ø‡§∏‡•ç‡§ü ‡§Æ‡•á‡§Ç ‡§ï‡§æ‡§∞‡•ç‡§° ‡§¨‡§®‡§æ‡§®‡§æ
        function addImageCard(dataURL) {
            const id = Date.now();
            
            const newImage = {
                id: id,
                originalDataURL: dataURL, // ‡§π‡§Æ‡•á‡§∂‡§æ ‡§ì‡§∞‡§ø‡§ú‡§ø‡§®‡§≤ URL ‡§∞‡§ñ‡•á‡§Ç
                editedDataURL: dataURL,   // ‡§è‡§°‡§ø‡§ü‡§ø‡§Ç‡§ó ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§ï‡§æ URL
                filter: 'original',
                cropData: null,
            };
            imagesData.push(newImage);

            const card = document.createElement('div');
            card.className = 'image-card';
            card.dataset.id = id;

            card.innerHTML = `
                <img src="${dataURL}" alt="Uploaded Image" id="img-preview-${id}">
                <select id="filter-select-${id}" class="filter-select" onchange="updateFilter(${id}, this.value)">
                    <option value="original">Original</option>
                    <option value="grayscale">Black & White</option>
                    <option value="sepia">Soft Tone (Sepia)</option>
                    <option value="vibrant">Vibrant</option>
                </select>
                <div class="edit-controls">
                    <button class="button" onclick="openCropModal(${id})">‡§ï‡•ç‡§∞‡•â‡§™ / ‡§è‡§°‡§µ‡§æ‡§Ç‡§∏ ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞</button>
                    <button class="button delete-btn" onclick="deleteImage(${id})">‡§π‡§ü‡§æ‡§è‡§Å</button>
                </div>
            `;
            imageList.appendChild(card);
        }

        // 3. ‡§∏‡§ø‡§Ç‡§ó‡§≤ ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡§®‡§æ (‡§∏‡§ø‡§∞‡•ç‡§´‡§º ‡§™‡•ç‡§∞‡•Ä‡§µ‡•ç‡§Ø‡•Ç ‡§ï‡•á ‡§≤‡§ø‡§è)
        function updateFilter(id, filterValue) {
            const imgData = imagesData.find(img => img.id === id);
            const imgElement = document.getElementById(`img-preview-${id}`);
            
            imgData.filter = filterValue; // ‡§°‡•á‡§ü‡§æ ‡§Æ‡•á‡§Ç ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç

            // CSS Filter ‡§∏‡§ø‡§∞‡•ç‡§´‡§º ‡§™‡•ç‡§∞‡•Ä‡§µ‡•ç‡§Ø‡•Ç ‡§™‡§∞ ‡§≤‡§æ‡§ó‡•Ç ‡§ï‡§∞‡•á‡§Ç
            applyCssFilter(imgElement, filterValue);
        }

        function applyCssFilter(element, filter) {
            switch (filter) {
                case 'grayscale':
                    element.style.filter = 'grayscale(100%)';
                    break;
                case 'sepia':
                    element.style.filter = 'sepia(80%) saturate(120%)';
                    break;
                case 'vibrant':
                    element.style.filter = 'saturate(150%) brightness(110%)';
                    break;
                case 'original':
                default:
                    element.style.filter = 'none';
                    break;
            }
        }


        // 4. ‡§ï‡•ç‡§∞‡•â‡§™‡§ø‡§Ç‡§ó ‡§Æ‡•â‡§°‡§≤ ‡§ñ‡•ã‡§≤‡§®‡§æ
        function openCropModal(id) {
            const imgData = imagesData.find(img => img.id === id);
            currentImageId = id;
            
            // Cropper.js ‡§ï‡•ã Destroy ‡§ï‡§∞‡•á‡§Ç ‡§Ö‡§ó‡§∞ ‡§Ø‡§π ‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§Æ‡•å‡§ú‡•Ç‡§¶ ‡§π‡•à
            if (cropperInstance) {
                cropperInstance.destroy();
            }

            cropImage.src = imgData.originalDataURL;
            modalFilterSelect.value = imgData.filter; // ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§µ‡•à‡§≤‡•ç‡§Ø‡•Ç ‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç
            
            cropModal.style.display = "block";
            
            // Cropper.js ‡§ï‡•ã ‡§≤‡•ã‡§° ‡§π‡•ã‡§®‡•á ‡§Æ‡•á‡§Ç ‡§•‡•ã‡§°‡§º‡§æ ‡§∏‡§Æ‡§Ø ‡§¶‡•á‡§Ç
            setTimeout(() => {
                cropperInstance = new Cropper(cropImage, {
                    aspectRatio: NaN, // ‡§´‡•ç‡§∞‡•Ä ‡§ï‡•ç‡§∞‡•â‡§™‡§ø‡§Ç‡§ó
                    viewMode: 1,
                    initialAspectRatio: imgData.cropData ? imgData.cropData.width / imgData.cropData.height : NaN,
                    ready: function () {
                        if (imgData.cropData) {
                            // ‡§Ö‡§ó‡§∞ ‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§ï‡•ç‡§∞‡•â‡§™ ‡§°‡•á‡§ü‡§æ ‡§π‡•à ‡§§‡•ã ‡§â‡§∏‡•á ‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç
                            this.cropper.setData(imgData.cropData);
                        }
                    }
                });
            }, 100);
        }
        
        // 5. ‡§ï‡•ç‡§∞‡•â‡§™‡§ø‡§Ç‡§ó ‡§î‡§∞ ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§≤‡§æ‡§ó‡•Ç ‡§ï‡§∞‡§®‡§æ (‡§∏‡§¨‡§∏‡•á ‡§ú‡§º‡§∞‡•Ç‡§∞‡•Ä ‡§π‡§ø‡§∏‡•ç‡§∏‡§æ)
        function applyCropAndFilter() {
            const id = currentImageId;
            const imgData = imagesData.find(img => img.id === id);
            const selectedFilter = modalFilterSelect.value;

            if (!cropperInstance) return;

            // 5a. ‡§ï‡•ç‡§∞‡•â‡§™ ‡§°‡•á‡§ü‡§æ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§∏‡•ç‡§ü‡•ã‡§∞ ‡§ï‡§∞‡•á‡§Ç
            const cropData = cropperInstance.getData();
            imgData.cropData = cropData; 

            // 5b. ‡§ï‡•à‡§®‡§µ‡§æ‡§∏ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§á‡§Æ‡•á‡§ú ‡§ï‡•ã ‡§ï‡•ç‡§∞‡•â‡§™ ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§≤‡§æ‡§ó‡•Ç ‡§ï‡§∞‡•á‡§Ç
            const croppedCanvas = cropperInstance.getCroppedCanvas();
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');

            canvas.width = croppedCanvas.width;
            canvas.height = croppedCanvas.height;

            // ‡§ï‡•à‡§®‡§µ‡§æ‡§∏ ‡§™‡§∞ ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§≤‡§æ‡§ó‡•Ç ‡§ï‡§∞‡•á‡§Ç
            applyCanvasFilter(ctx, selectedFilter);

            // cropped image ‡§ï‡•ã canvas ‡§™‡§∞ draw ‡§ï‡§∞‡•á‡§Ç
            ctx.drawImage(croppedCanvas, 0, 0, canvas.width, canvas.height);

            // ‡§´‡§æ‡§á‡§®‡§≤ ‡§°‡•á‡§ü‡§æ URL ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç
            const finalDataURL = canvas.toDataURL('image/jpeg', 0.9);
            
            // 5c. ‡§°‡•á‡§ü‡§æ ‡§î‡§∞ ‡§™‡•ç‡§∞‡•Ä‡§µ‡•ç‡§Ø‡•Ç ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç
            imgData.editedDataURL = finalDataURL;
            imgData.filter = selectedFilter; // ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§°‡•á‡§ü‡§æ ‡§Æ‡•á‡§Ç ‡§∏‡•á‡§µ ‡§ï‡§∞‡•á‡§Ç
            
            // ‡§Æ‡•á‡§® ‡§≤‡§ø‡§∏‡•ç‡§ü ‡§ï‡•á ‡§™‡•ç‡§∞‡•Ä‡§µ‡•ç‡§Ø‡•Ç ‡§ï‡•ã ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç
            const previewImg = document.getElementById(`img-preview-${id}`);
            previewImg.src = finalDataURL;
            previewImg.style.filter = 'none'; // Canvas ‡§®‡•á ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§≤‡§æ‡§ó‡•Ç ‡§ï‡§∞ ‡§¶‡§ø‡§Ø‡§æ ‡§π‡•à
            
            // ‡§Æ‡•á‡§® ‡§≤‡§ø‡§∏‡•ç‡§ü ‡§ï‡•á ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§∏‡•á‡§≤‡•á‡§ï‡•ç‡§ü‡§∞ ‡§ï‡•ã ‡§≠‡•Ä ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç
            document.getElementById(`filter-select-${id}`).value = selectedFilter;
            
            closeModal();
            alert("‡§ï‡•ç‡§∞‡•â‡§™ ‡§î‡§∞ ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§≤‡§æ‡§ó‡•Ç ‡§ï‡§ø‡§è ‡§ó‡§è!");
        }

        // ‡§ï‡•à‡§®‡§µ‡§æ‡§∏ ‡§™‡§∞ ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§≤‡§ó‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§®
        function applyCanvasFilter(ctx, filter) {
            switch (filter) {
                case 'grayscale':
                    ctx.filter = 'grayscale(100%)';
                    break;
                case 'sepia':
                    ctx.filter = 'sepia(80%) saturate(120%)';
                    break;
                case 'vibrant':
                    ctx.filter = 'saturate(150%) brightness(110%)';
                    break;
                case 'original':
                default:
                    ctx.filter = 'none';
                    break;
            }
        }

        // 6. ‡§Æ‡•â‡§°‡§≤ ‡§¨‡§Ç‡§¶ ‡§ï‡§∞‡§®‡§æ
        function closeModal() {
            cropModal.style.display = "none";
            if (cropperInstance) {
                cropperInstance.destroy();
                cropperInstance = null;
            }
        }
        
        // 7. ‡§á‡§Æ‡•á‡§ú ‡§π‡§ü‡§æ‡§®‡§æ
        function deleteImage(id) {
            const card = document.querySelector(`.image-card[data-id="${id}"]`);
            if (card) {
                card.remove();
                imagesData = imagesData.filter(img => img.id !== id);
            }
        }

        // 8. PDF ‡§Æ‡•á‡§Ç ‡§ï‡§®‡•ç‡§µ‡§∞‡•ç‡§ü ‡§ï‡§∞‡§®‡§æ
        function convertToPDF() {
            if (imagesData.length === 0) {
                alert("‡§™‡§π‡§≤‡•á ‡§è‡§ï ‡§Ø‡§æ ‡§è‡§ï ‡§∏‡•á ‡§ú‡§º‡•ç‡§Ø‡§æ‡§¶‡§æ ‡§á‡§Æ‡•á‡§ú ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç!");
                return;
            }

            const doc = new jsPDF();
            let isFirstPage = true;

            imagesData.forEach((imgData, index) => {
                if (!isFirstPage) {
                    doc.addPage();
                }
                
                const finalDataURL = imgData.editedDataURL; // ‡§è‡§°‡§ø‡§ü ‡§ï‡•Ä ‡§ó‡§à ‡§á‡§Æ‡•á‡§ú ‡§ï‡§æ URL ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç

                const imgProps = doc.getImageProperties(finalDataURL);
                const pdfWidth = doc.internal.pageSize.getWidth();
                const pdfHeight = doc.internal.pageSize.getHeight();
                const ratio = imgProps.width / imgProps.height;
                
                // ‡§á‡§Æ‡•á‡§ú ‡§ï‡•ã A4 ‡§™‡•á‡§ú ‡§™‡§∞ ‡§´‡§ø‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•à‡§≤‡§ï‡•Å‡§≤‡•á‡§∂‡§®
                let finalImgWidth = pdfWidth * 0.9;
                let finalImgHeight = finalImgWidth / ratio;

                if (finalImgHeight > pdfHeight * 0.9) { 
                    finalImgHeight = pdfHeight * 0.9;
                    finalImgWidth = finalImgHeight * ratio;
                }

                const x = (pdfWidth - finalImgWidth) / 2;
                const y = (pdfHeight - finalImgHeight) / 2;

                doc.addImage(finalDataURL, 'JPEG', x, y, finalImgWidth, finalImgHeight);
                isFirstPage = false;
            });
            
            doc.save("edited_images_to_pdf.pdf");
        }
    </script>
</body>
</html>
