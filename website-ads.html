<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EDU-TKN माइनिंग डैशबोर्ड (Real Transfer)</title>
    <style>
        /* --- CSS स्टाइल --- */
        body {
            font-family: 'Arial', sans-serif;
            background-color: #0d1117; /* Dark Background */
            color: #c9d1d9; /* Light Text */
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .dashboard-container {
            background-color: #161b22; 
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            width: 100%;
            max-width: 800px;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
        }

        header h1 {
            color: #58a6ff; 
            font-size: 2.5em;
            margin-bottom: 5px;
        }

        .control-panel {
            text-align: center;
            margin-bottom: 25px;
        }

        #mining-status-text {
            font-size: 1.5em;
            margin-bottom: 15px;
        }

        .speed-control {
            margin-top: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
        }

        #mining-speed {
            padding: 10px;
            border-radius: 6px;
            border: 1px solid #30363d;
            background-color: #0d1117;
            color: #c9d1d9;
            width: 150px;
        }

        .btn-start, .btn-stop, .btn-withdraw {
            padding: 12px 25px;
            border: none;
            border-radius: 6px;
            font-size: 1em;
            cursor: pointer;
            transition: background-color 0.3s;
            font-weight: bold;
        }

        .btn-start {
            background-color: #2ea44f; /* Green */
            color: white;
        }
        .btn-start:hover { background-color: #2c974b; }

        .btn-stop {
            background-color: #f85149; /* Red */
            color: white;
        }
        .btn-stop:hover { background-color: #da3633; }

        .btn-withdraw {
            background-color: #58a6ff; /* Blue */
            color: white;
            width: 100%;
            margin-top: 15px;
        }
        .btn-withdraw:disabled {
            background-color: #30363d;
            cursor: not-allowed;
        }

        .metrics-panel {
            margin-bottom: 30px;
        }

        .metrics-panel h2 {
            text-align: center;
            color: #79c0ff;
            margin-bottom: 20px;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .metric-card {
            background-color: #21262d;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #30363d;
        }

        .metric-card h3 {
            margin-top: 0;
            font-size: 0.9em;
            color: #8b949e;
        }

        .metric-card p {
            font-size: 2em;
            font-weight: bold;
            color: #c9d1d9;
            margin: 5px 0 0;
        }

        .withdrawal-panel h2 {
            text-align: center;
            color: #79c0ff;
            margin-bottom: 20px;
        }

        .info-text {
            text-align: center;
            color: #e3b341; 
            margin-bottom: 15px;
        }

        .withdrawal-form input[type="text"] {
            width: 100%;
            padding: 12px;
            border-radius: 6px;
            border: 1px solid #30363d;
            background-color: #0d1117;
            color: #c9d1d9;
            font-size: 1em;
            box-sizing: border-box;
        }

        .message {
            text-align: center;
            margin-top: 15px;
            font-weight: bold;
        }

        hr {
            border: 0;
            height: 1px;
            background-color: #30363d;
            margin: 30px 0;
        }
        /* --- CSS स्टाइल खत्म --- */
    </style>
</head>
<body>

    <div class="dashboard-container">
        <header>
            <h1>EDU-TKN माइनिंग सिस्टम ⛏️</h1>
            <p>प्रोफेसरों के लिए वास्तविक क्रिप्टो रिवॉर्ड</p>
        </header>

        <section class="control-panel">
            <h2 id="mining-status-text">माइनिंग स्टेटस: STOPPED</h2>
            <button id="mining-toggle-btn" class="btn-start">माइनिंग शुरू करें</button>
            <div class="speed-control">
                <label for="mining-speed">माइनिंग स्पीड (Earning Rate):</label>
                <select id="mining-speed">
                    <option value="Low">Low (5 TKN/मिनट)</option>
                    <option value="Medium">Medium (10 TKN/मिनट)</option>
                    <option value="High">High (20 TKN/मिनट)</option>
                </select>
            </div>
        </section>

        <hr>

        <section class="metrics-panel">
            <h2>कमाई के आंकड़े</h2>
            <div class="metrics-grid">
                <div class="metric-card">
                    <h3>वर्तमान बैलेंस (EDU-TKN)</h3>
                    <p id="tkn-balance">0</p>
                </div>
                <div class="metric-card">
                    <h3>USD के बराबर (लगभग)</h3>
                    <p id="usd-equivalent">$0.00</p>
                </div>
                <div class="metric-card">
                    <h3>सिम्युलेटेड हैश रेट</h3>
                    <p id="hash-rate">0 H/s</p>
                </div>
            </div>
        </section>

        <hr>

        <section class="withdrawal-panel">
            <h2>निकासी (Withdrawal)</h2>
            <p class="info-text">निकासी के लिए न्यूनतम 10,000 EDU-TKN ($1) आवश्यक है। वास्तविक क्रिप्टो (GUSD/DAI) ट्रांसफर होगा।</p>
            <div class="withdrawal-form">
                <input type="text" id="wallet-address" placeholder="Binance / Trust Wallet का पता यहाँ डालें">
                <button id="withdraw-btn" class="btn-withdraw" disabled>निकासी का अनुरोध करें</button>
            </div>
            <p id="withdrawal-message" class="message"></p>
        </section>
    </div>

    <script>
        // --- JavaScript लॉजिक ---
        document.addEventListener('DOMContentLoaded', () => {
            const TKN_TO_USD_RATE = 10000; // 10,000 TKN = $1 USD
            const MIN_WITHDRAWAL_TKN = 10000;
            // आपका Render Cloud URL यहाँ है
            const BASE_URL = 'https://pooreyoutuber-github-io-blmp.onrender.com'; 

            let isMining = false;
            let balanceTKN = 0; // यह अस्थायी बैलेंस है, Node.js बैकएंड इसे संभालेगा
            let timerInterval;

            // DOM Elements
            const statusText = document.getElementById('mining-status-text');
            const toggleBtn = document.getElementById('mining-toggle-btn');
            const speedSelect = document.getElementById('mining-speed');
            const tknBalanceEl = document.getElementById('tkn-balance');
            const usdEquivalentEl = document.getElementById('usd-equivalent');
            const hashRateEl = document.getElementById('hash-rate');
            const withdrawBtn = document.getElementById('withdraw-btn');
            const walletAddressInput = document.getElementById('wallet-address');
            const withdrawalMessageEl = document.getElementById('withdrawal-message');
            
            // यह एक डमी प्रोफेसर ID है, जिसे बाद में लॉगिन सिस्टम से बदला जाएगा
            const PROFESSOR_ID = 'clg_prof_123'; 

            // --- Core Functions ---

            /**
             * स्पीड के आधार पर TKN/मिनट दिखाता है।
             */
            function getTokensPerMinute() {
                const speed = speedSelect.value;
                if (speed === 'High') return 20;
                if (speed === 'Medium') return 10;
                return 5; // Low
            }

            /**
             * UI को वर्तमान बैलेंस और स्थिति के साथ अपडेट करता है।
             */
            function updateUI() {
                const usdValue = (balanceTKN / TKN_TO_USD_RATE).toFixed(4);
                const tknPerMin = getTokensPerMinute();

                tknBalanceEl.textContent = Math.floor(balanceTKN).toLocaleString(); // पूर्णांक दिखाना
                usdEquivalentEl.textContent = `$${usdValue}`;
                
                // माइनिंग सिमुलेशन दिखाने के लिए हैश रेट
                hashRateEl.textContent = isMining ? `${tknPerMin * 100} MH/s` : '0 H/s';

                // निकासी बटन की स्थिति
                const isAddressValid = walletAddressInput.value.length > 20;
                if (balanceTKN >= MIN_WITHDRAWAL_TKN && isAddressValid) {
                    withdrawBtn.disabled = false;
                } else {
                    withdrawBtn.disabled = true;
                }

                // स्टेटस अपडेट
                statusText.textContent = isMining ? 'माइनिंग स्टेटस: RUNNING' : 'माइनिंग स्टेटस: STOPPED';
                statusText.style.color = isMining ? '#2ea44f' : '#f85149';
            }

            /**
             * माइनिंग सिमुलेशन को शुरू/बंद करता है।
             */
            function toggleMining() {
                isMining = !isMining;
                
                if (isMining) {
                    // माइनिंग शुरू करें
                    toggleBtn.textContent = 'माइनिंग बंद करें';
                    toggleBtn.className = 'btn-stop';
                    speedSelect.disabled = true;
                    
                    // हर 1 सेकंड में अपडेट करने का सिमुलेशन
                    timerInterval = setInterval(simulateMiningCycle, 1000); 

                    // TODO: Node.js API Call to START MINING
                    // fetch(`${BASE_URL}/api/start-mining`, { method: 'POST', ... });

                } else {
                    // माइनिंग बंद करें
                    clearInterval(timerInterval);
                    toggleBtn.textContent = 'माइनिंग शुरू करें';
                    toggleBtn.className = 'btn-start';
                    speedSelect.disabled = false;

                    // TODO: Node.js API Call to STOP MINING
                }
                updateUI();
            }

            /**
             * माइनिंग का एक चक्र चलाता है (हर 1 सेकंड में)।
             */
            function simulateMiningCycle() {
                const tknEarnedPerMinute = getTokensPerMinute();
                // 1 मिनट में 60 सेकंड होते हैं
                const tknEarnedPerSecond = tknEarnedPerMinute / 60; 
                balanceTKN += tknEarnedPerSecond;
                
                // TODO: Node.js API Call to UPDATE BALANCE (यह सर्वर साइड पर होना चाहिए)
                /*
                fetch(`${BASE_URL}/api/mine`, { 
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        user_id: PROFESSOR_ID, 
                        speed: speedSelect.value, 
                        tkn_earned: tknEarnedPerSecond 
                    })
                })
                .then(response => response.json())
                .then(data => {
                     // balanceTKN = data.current_balance; // Real balance from server
                     updateUI();
                });
                */
                
                updateUI();
            }
            
            // --- Event Listeners ---
            toggleBtn.addEventListener('click', toggleMining);
            speedSelect.addEventListener('change', updateUI);
            walletAddressInput.addEventListener('input', updateUI);

            withdrawBtn.addEventListener('click', () => {
                const address = walletAddressInput.value;
                const amountTKN = balanceTKN;

                if (amountTKN < MIN_WITHDRAWAL_TKN || !address) {
                    withdrawalMessageEl.textContent = 'निकासी की आवश्यकताएँ पूरी नहीं हुई हैं।';
                    withdrawalMessageEl.style.color = '#f85149';
                    return;
                }

                // UI अपडेट
                withdrawalMessageEl.textContent = 'निकासी का अनुरोध भेजा जा रहा है... कृपया प्रतीक्षा करें।';
                withdrawalMessageEl.style.color = '#e3b341';
                withdrawBtn.disabled = true;

                // TODO: Node.js API Call for REAL TRANSFER (Gemini Withdrawal)
                /*
                fetch(`${BASE_URL}/api/withdraw`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        user_id: PROFESSOR_ID,
                        address: address, 
                        amount_usd: (amountTKN / TKN_TO_USD_RATE).toFixed(2) // $USD amount
                    })
                })
                .then(response => response.json())
                .then(data => {
                    withdrawBtn.disabled = false;
                    if (data.success) {
                        balanceTKN = 0; // Server cleared the balance
                        withdrawalMessageEl.textContent = `सफल! ${data.message}`; 
                        withdrawalMessageEl.style.color = '#2ea44f';
                    } else {
                        withdrawalMessageEl.textContent = `त्रुटि: ${data.message}`; 
                        withdrawalMessageEl.style.color = '#f85149';
                    }
                    updateUI();
                })
                .catch(error => {
                    //... Error handling
                });
                */

                // 3 सेकंड के बाद सिमुलेशन सफल दिखाएं
                setTimeout(() => {
                    const withdrawnUSD = (amountTKN / TKN_TO_USD_RATE).toFixed(2);
                    balanceTKN = 0;
                    withdrawalMessageEl.textContent = `निकासी सफल! $${withdrawnUSD} का ट्रांसफर अनुरोध भेजा गया है। (यह आपके वॉलेट में वास्तविक क्रिप्टो भेजेगा)`;
                    withdrawalMessageEl.style.color = '#2ea44f';
                    withdrawBtn.disabled = false;
                    updateUI();
                }, 3000);
            });

            // Initial load
            updateUI();
        });
        // --- JavaScript लॉजिक खत्म ---
    </script>
</body>
</html>
