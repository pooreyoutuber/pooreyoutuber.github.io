<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anime Style Video Converter</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* Global Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        body {
            background: #0d1117; /* Dark Background */
            color: #c9d1d9;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .converter-container {
            width: 100%;
            max-width: 900px;
            background: #161b22;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            text-align: center;
        }

        .title {
            font-size: 2.5em;
            font-weight: 700;
            color: #58a6ff; /* Blue Highlight */
            margin-bottom: 5px;
        }

        .subtitle {
            font-size: 1.1em;
            color: #8b949e;
            margin-bottom: 30px;
        }

        /* --- Upload Box Styles --- */
        .upload-box {
            border: 3px dashed #30363d;
            background: #0d1117;
            padding: 40px 20px;
            margin-bottom: 30px;
            border-radius: 8px;
            transition: border-color 0.3s, background 0.3s;
        }

        .upload-box.drag-over {
            border-color: #58a6ff;
            background: #1f2a3a;
        }

        .file-name-display {
            margin-top: 10px;
            font-weight: 600;
            color: #58a6ff;
        }

        /* --- Buttons Styles --- */
        .main-btn, .convert-btn {
            background: #238636; /* Green */
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: background 0.2s, transform 0.1s;
            margin-top: 15px;
        }

        .main-btn:hover, .convert-btn:hover {
            background: #2ea043;
        }

        /* --- Style Grid Styles --- */
        .styles-grid {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-bottom: 40px;
        }

        .style-item {
            background: transparent;
            border: 3px solid transparent;
            border-radius: 50%;
            padding: 5px;
            cursor: pointer;
            transition: border-color 0.2s;
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 120px;
        }

        .style-item img {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
            margin-bottom: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }

        .style-item span {
            color: #8b949e;
            font-size: 0.9em;
            font-weight: 600;
        }

        .style-item.selected {
            border-color: #58a6ff;
        }

        .style-item.selected span {
            color: #c9d1d9;
        }

        /* --- Status/Progress Styles --- */
        .status-area {
            padding: 20px;
        }

        .progress-bar-container {
            background: #30363d;
            height: 10px;
            border-radius: 5px;
            margin-top: 10px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #58a6ff, #238636);
            transition: width 0.4s ease-in-out;
        }

        /* --- Download Styles --- */
        .download-btn {
            width: 200px;
            background: #03c737;
        }

        .download-btn:hover {
            background: #02a12c;
        }
        
        .message {
            margin-top: 20px;
            padding: 10px;
            border-radius: 4px;
            font-weight: 600;
        }

        .error {
            background: #f8514933;
            color: #f85149;
            border: 1px solid #f85149;
        }

        .success {
            background: #23863633;
            color: #238636;
            border: 1px solid #238636;
        }
    </style>
</head>
<body>
    <div class="converter-container">
        <h1 class="title">Anime Style Video Converter</h1>
        <p class="subtitle">Transform Your Videos into Anime!</p>

        <div id="upload-area" class="upload-box">
            <p>Drag & Drop your video here, or Click to Upload (Max 30 seconds)</p>
            <input type="file" id="videoFileInput" accept="video/*" hidden>
            <button id="upload-btn" class="main-btn" onclick="document.getElementById('videoFileInput').click();">
                Upload Video
            </button>
            <p id="file-name" class="file-name-display"></p>
        </div>

        <div id="style-selection" class="styles-grid" style="display: none;">
            <button class="style-item" data-style="what-if">
                <img src="https://i.imgur.com/kS9A00L.png" alt="What If...?">
                <span>What If...?</span>
            </button>
            <button class="style-item selected" data-style="ben-10-classic">
                <img src="https://i.imgur.com/z4Dq5fW.png" alt="Ben 10 Classic">
                <span>Ben 10 Classic</span>
            </button>
            <button class="style-item" data-style="jujutsu-kaisen">
                <img src="https://i.imgur.com/s6E7jU8.png" alt="Jujutsu Kaisen">
                <span>Jujutsu Kaisen</span>
            </button>
        </div>

        <div id="status-area" class="status-area" style="display: none;">
            <p id="status-message">Converting... Please wait!</p>
            <div class="progress-bar-container">
                <div id="progress-bar" class="progress-bar"></div>
            </div>
        </div>
        
        <div id="download-area" class="download-area" style="display: none;">
            <a id="download-link" href="#" target="_blank">
                <button class="main-btn download-btn">Download</button>
            </a>
        </div>
    </div>

    <script>
        // --- à¤•à¥‰à¤¨à¥à¤«à¤¼à¤¿à¤—à¤°à¥‡à¤¶à¤¨ ---
        // à¤†à¤ªà¤•à¥‡ Render Cloud URL à¤•à¤¾ à¤‰à¤ªà¤¯à¥‹à¤— API à¤¬à¥‡à¤¸ URL à¤•à¥‡ à¤°à¥‚à¤ª à¤®à¥‡à¤‚
        const API_BASE_URL = 'https://pooreyoutuber-github-io-v2fo.onrender.com';
        const CONVERSION_ENDPOINT = '/anime-convert'; 

        // --- DOM à¤à¤²à¥€à¤®à¥‡à¤‚à¤Ÿ ---
        const uploadArea = document.getElementById('upload-area');
        const videoFileInput = document.getElementById('videoFileInput');
        const uploadBtn = document.getElementById('upload-btn');
        const fileNameDisplay = document.getElementById('file-name');
        const styleSelectionArea = document.getElementById('style-selection');
        const styleButtons = document.querySelectorAll('.style-item');
        const statusArea = document.getElementById('status-area');
        const statusMessage = document.getElementById('status-message');
        const progressBar = document.getElementById('progress-bar');
        const downloadArea = document.getElementById('download-area');
        const downloadLink = document.getElementById('download-link');

        let selectedStyle = 'ben-10-classic'; 
        let videoFile = null;

        // --- à¤‡à¤µà¥‡à¤‚à¤Ÿ à¤²à¤¿à¤¸à¤¨à¤°à¥à¤¸ ---

        // 1. Drag & Drop à¤‡à¤µà¥‡à¤‚à¤Ÿà¥à¤¸
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('drag-over');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('drag-over');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('drag-over');
            const files = e.dataTransfer.files;
            if (files.length) {
                handleFile(files[0]);
            }
        });

        // 2. à¤«à¤¼à¤¾à¤‡à¤² à¤‡à¤¨à¤ªà¥à¤Ÿ à¤ªà¤°à¤¿à¤µà¤°à¥à¤¤à¤¨
        videoFileInput.addEventListener('change', (e) => {
            if (e.target.files.length) {
                handleFile(e.target.files[0]);
            }
        });

        // 3. à¤¸à¥à¤Ÿà¤¾à¤‡à¤² à¤¬à¤Ÿà¤¨ à¤•à¥à¤²à¤¿à¤•
        styleButtons.forEach(button => {
            button.addEventListener('click', () => {
                styleButtons.forEach(btn => btn.classList.remove('selected'));
                button.classList.add('selected');
                selectedStyle = button.getAttribute('data-style');
            });
        });

        // 4. à¤…à¤ªà¤²à¥‹à¤¡/à¤•à¤¨à¥à¤µà¤°à¥à¤Ÿ à¤¬à¤Ÿà¤¨ à¤•à¥à¤²à¤¿à¤•
        uploadBtn.addEventListener('click', (e) => {
            if (videoFile) {
                e.preventDefault();
                startConversion();
            }
        });


        // --- à¤«à¤¼à¤‚à¤•à¥à¤¶à¤¨ à¤²à¥‰à¤œà¤¿à¤• ---

        function handleFile(file) {
            if (!file.type.startsWith('video/')) {
                alert("à¤•à¥ƒà¤ªà¤¯à¤¾ à¤•à¥‡à¤µà¤² à¤à¤• à¤µà¥€à¤¡à¤¿à¤¯à¥‹ à¤«à¤¼à¤¾à¤‡à¤² à¤…à¤ªà¤²à¥‹à¤¡ à¤•à¤°à¥‡à¤‚à¥¤");
                return;
            }
            if (file.size > 30 * 1024 * 1024) { // 30 MB
                alert("à¤µà¥€à¤¡à¤¿à¤¯à¥‹ à¤•à¤¾ à¤†à¤•à¤¾à¤° 30 MB à¤¸à¥‡ à¤…à¤§à¤¿à¤• à¤¨à¤¹à¥€à¤‚ à¤¹à¥‹à¤¨à¤¾ à¤šà¤¾à¤¹à¤¿à¤à¥¤");
                return;
            }
            
            videoFile = file;
            fileNameDisplay.textContent = `Selected: ${file.name}`;
            
            // UI à¤…à¤ªà¤¡à¥‡à¤Ÿ à¤•à¤°à¥‡à¤‚: à¤…à¤ªà¤²à¥‹à¤¡ à¤¬à¤Ÿà¤¨ à¤•à¥‹ à¤•à¤¨à¥à¤µà¤°à¥à¤Ÿ à¤¬à¤Ÿà¤¨ à¤®à¥‡à¤‚ à¤¬à¤¦à¤²à¥‡à¤‚
            uploadBtn.textContent = 'Convert to Anime!';
            uploadBtn.classList.add('convert-btn');
            uploadBtn.classList.remove('main-btn');

            // à¤¸à¥à¤Ÿà¤¾à¤‡à¤² à¤šà¤¯à¤¨ à¤•à¥à¤·à¥‡à¤¤à¥à¤° à¤¦à¤¿à¤–à¤¾à¤à¤
            styleSelectionArea.style.display = 'flex';
        }

        function showStatus(message, isError = false) {
            statusArea.style.display = 'block';
            statusMessage.textContent = message;
            statusMessage.className = 'message';
            if (isError) {
                statusMessage.classList.add('error');
            } else {
                statusMessage.classList.add('success');
            }
        }

        function updateProgress(percent) {
            progressBar.style.width = `${percent}%`;
            statusMessage.textContent = `Converting... ${Math.floor(percent)}%`;
        }


        async function startConversion() {
            if (!videoFile) return;

            // UI à¤•à¥‹ à¤ªà¥à¤°à¥‹à¤¸à¥‡à¤¸à¤¿à¤‚à¤— à¤®à¥‹à¤¡ à¤®à¥‡à¤‚ à¤¬à¤¦à¤²à¥‡à¤‚
            uploadArea.style.display = 'none';
            styleSelectionArea.style.display = 'none';
            downloadArea.style.display = 'none';
            statusArea.style.display = 'block';
            
            // --- ðŸš€ API à¤•à¥‰à¤² ---
            
            const formData = new FormData();
            formData.append('video', videoFile);
            formData.append('style', selectedStyle);
            
            // à¤¡à¤®à¥€ à¤ªà¥à¤°à¥‹à¤—à¥à¤°à¥‡à¤¸ à¤…à¤ªà¤¡à¥‡à¤Ÿ (à¤•à¥à¤¯à¥‹à¤‚à¤•à¤¿ à¤¹à¤® à¤•à¥à¤²à¤¾à¤‡à¤‚à¤Ÿ à¤¸à¤¾à¤‡à¤¡ à¤¸à¥‡ à¤µà¤¾à¤¸à¥à¤¤à¤µà¤¿à¤• à¤¬à¥ˆà¤•à¤à¤‚à¤¡ à¤ªà¥à¤°à¥‹à¤¸à¥‡à¤¸à¤¿à¤‚à¤— à¤•à¥‹ à¤Ÿà¥à¤°à¥ˆà¤• à¤¨à¤¹à¥€à¤‚ à¤•à¤° à¤¸à¤•à¤¤à¥‡)
            const interval = setInterval(() => {
                let currentWidth = parseFloat(progressBar.style.width || 10);
                if (currentWidth < 90) {
                    // à¤§à¥€à¤°à¥‡-à¤§à¥€à¤°à¥‡ 90% à¤¤à¤• à¤¬à¤¢à¤¼à¤¾à¤à¤
                    updateProgress(currentWidth + Math.random() * 5); 
                }
            }, 1000);


            try {
                const response = await fetch(API_BASE_URL + CONVERSION_ENDPOINT, {
                    method: 'POST',
                    body: formData,
                });

                clearInterval(interval); // à¤ªà¥à¤°à¥‹à¤—à¥à¤°à¥‡à¤¸ à¤…à¤ªà¤¡à¥‡à¤Ÿ à¤¬à¤‚à¤¦ à¤•à¤°à¥‡à¤‚

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.message || 'Conversion failed on the server.');
                }

                const result = await response.json();
                
                // à¤¸à¤«à¤²à¤¤à¤¾!
                updateProgress(100);
                showStatus('âœ… Conversion Complete! Your Anime Video is Ready.', false);
                
                downloadLink.href = result.downloadUrl; 
                downloadArea.style.display = 'block';

            } catch (error) {
                clearInterval(interval);
                updateProgress(0); 
                showStatus(`âŒ Error: ${error.message}`, true);
                
                // à¤µà¤¿à¤«à¤² à¤¹à¥‹à¤¨à¥‡ à¤ªà¤° UI à¤•à¥‹ à¤µà¤¾à¤ªà¤¸ à¤…à¤ªà¤²à¥‹à¤¡ à¤®à¥‹à¤¡ à¤®à¥‡à¤‚ à¤°à¥€à¤¸à¥‡à¤Ÿ à¤•à¤°à¥‡à¤‚
                setTimeout(() => {
                    location.reload(); // à¤¸à¤¬à¤¸à¥‡ à¤†à¤¸à¤¾à¤¨ à¤°à¥€à¤¸à¥‡à¤Ÿ
                }, 5000);

            }
        }
    </script>
</body>
</html>
