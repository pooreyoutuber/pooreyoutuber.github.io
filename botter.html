<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>GA4 Traffic Injector - Final Code</title>
    
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding-top: 50px;
            background-color: #f4f4f4;
        }
        #status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            display: inline-block;
            text-align: left;
            min-width: 400px;
        }
        .success { color: green; font-weight: bold; }
        .error { color: red; font-weight: bold; }
    </style>
</head>
<body>

    <h1>GA4 рдЯреНрд░реИрдлрд┐рдХ рд╕рд┐рдореБрд▓реЗрд╢рди (рдлрд╛рдЗрдирд▓)</h1>
    <p>рд▓рдХреНрд╖реНрдп: 250 рд╡реНрдпреВрдЬрд╝ рдФрд░ рдпреВрдЬрд╝рд░реНрд╕</p>
    <div id="status">рд╕рд┐рдореБрд▓реЗрд╢рди рд╢реБрд░реВ рд╣реЛ рд░рд╣рд╛ рд╣реИ...</div>

    <script>
        // --- ЁЯОп рдпрд╣рд╛рдБ рдЖрдкрдХреЛ рд╕рд┐рд░реНрдлрд╝ рдпрд╣ 3 рдЪреАрдЬрд╝реЗрдВ рдмрджрд▓рдиреА рд╣реИрдВ (рдЕрдкрдиреА рдЬрд╛рдирдХрд╛рд░реА рдзреНрдпрд╛рди рд╕реЗ рднрд░реЗрдВ) ---
        
        // 1. рдЕрдкрдиреА GA4 Measurement ID (G-XXXXXXX) рдпрд╣рд╛рдБ рдбрд╛рд▓реЗрдВред (рдЙрджрд╛рд╣рд░рдг: 'G-1A2B3C4D5E')
        const MEASUREMENT_ID = 'рдЕрдкрдиреА_G-XXXXXXX_ID_рдпрд╣рд╛рдБ_рдбрд╛рд▓реЗрдВ'; 
        
        // 2. рдЕрдкрдиреА рд╡реЗрдмрд╕рд╛рдЗрдЯ рдХрд╛ URL рдпрд╣рд╛рдБ рдбрд╛рд▓реЗрдВред (рдЙрджрд╛рд╣рд░рдг: 'https://username.github.io/my-project/')
        const WEBSITE_URL = 'рдЕрдкрдиреА_рд╡реЗрдмрд╕рд╛рдЗрдЯ_рдХрд╛_URL_рдпрд╣рд╛рдБ_рдбрд╛рд▓реЗрдВ'; 
        
        // 3. рдЖрдкрдХреЛ рдХреБрд▓ рдХрд┐рддрдиреЗ Views рдЪрд╛рд╣рд┐рдПред (рдЬрд╝рд░реВрд░рдд рдХреЗ рд╣рд┐рд╕рд╛рдм рд╕реЗ рдмрджрд▓реЗрдВ)
        const TOTAL_VIEWS = 250; 
        
        // ----------------------------------------------------------------------

        const MIN_DELAY = 1500; 
        const MAX_DELAY = 4000; 

        // ЁЯОп 15 рджреЗрд╢реЛрдВ рдХреА рд╕реВрдЪреА (рдпрд╣ рдЖрдкрдХреЗ Page Report рдореЗрдВ рджрд┐рдЦреЗрдЧреА)
        const countries = [
            "Japan", "United States", "Germany", "Canada", "Netherlands", "India",
            "Brazil", "Mexico", "South Korea", "Australia", "Singapore", "France",
            "Spain", "Italy", "Turkey" 
        ]; 

        let successfulViews = 0;
        let viewCount = 0;
        let countryIndex = 0;
        let clientId = Math.random().toString(36).substring(2, 12) + Date.now().toString(36); 

        const statusDiv = document.getElementById('status');
        
        // --- Validation Check (рдЬрд╝рд░реВрд░реА IDs рди рдмрджрд▓рдиреЗ рдкрд░ рдПрд░рд░ рджреЗрдЧрд╛) ---
        if (MEASUREMENT_ID.includes('рдЕрдкрдиреА_') || WEBSITE_URL.includes('рдЕрдкрдиреА_')) {
            document.body.innerHTML = '<h2>ЁЯЫС рдХреЛрдб рдореЗрдВ рдмрджрд▓рд╛рд╡ рдХрд░реЗрдВ!</h2><p>рдХреГрдкрдпрд╛ <code>script</code> рдЯреИрдЧ рдХреЗ рдЕрдВрджрд░ <code>MEASUREMENT_ID</code> рдФрд░ <code>WEBSITE_URL</code> рдХреЛ рдЕрдкрдиреА рдЕрд╕рд▓реА рдЬрд╛рдирдХрд╛рд░реА рд╕реЗ рдмрджрд▓реЗрдВред</p>';
            throw new Error("Missing configuration.");
        }


        function getNextCountry() {
            const country = countries[countryIndex % countries.length];
            countryIndex++;
            return country;
        }
        
        function updateStatus(message, className) {
            statusDiv.innerHTML = message;
            statusDiv.className = className || '';
        }

        function getRandomDelay() {
            return Math.random() * (MAX_DELAY - MIN_DELAY) + MIN_DELAY;
        }

        async function sendData(eventType, currentViewId, countryName) {
            // GA Endpoint (рд╕рд┐рд░реНрдлрд╝ Measurement ID рдХрд╛ рдЗрд╕реНрддреЗрдорд╛рд▓)
            const GA_ENDPOINT = `https://www.google-analytics.com/mp/collect?measurement_id=${MEASUREMENT_ID}`; 
            
            const SESSION_ID = Date.now();
            const engagementTime = 10000 + Math.floor(Math.random() * 10000);
            
            const payload = {
                client_id: clientId,
                events: [{
                    name: eventType,
                    params: {
                        session_id: SESSION_ID,
                        page_location: WEBSITE_URL, 
                        // Country Trick: Page Title рдореЗрдВ рджреЗрд╢ рдХрд╛ рдирд╛рдо
                        page_title: `PROJECT_VIEW_${currentViewId}_FROM_${countryName}`, 
                        engagement_time_msec: engagementTime,
                        _ss: eventType === 'session_start' ? 1 : undefined,
                        debug_mode: true
                    }
                }]
            };

            try {
                const response = await fetch(GA_ENDPOINT, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload),
                    mode: 'no-cors' 
                });

                if (response.status === 204 || response.type === 'opaque') {
                    if (eventType === 'page_view') {
                        successfulViews++;
                        updateStatus(`[SUCCESS] View ${currentViewId}: page_view рднреЗрдЬрд╛ рдЧрдпрд╛ред рджреЗрд╢: ${countryName}. рдХреБрд▓ рд╕рдлрд▓рддрд╛: ${successfulViews}`, 'success');
                    }
                    return true;
                } else {
                    updateStatus(`[FAILURE] View ${currentViewId}: Status ${response.status}.`, 'error');
                    return false;
                }
            } catch (error) {
                updateStatus(`[ERROR] View ${currentViewId}: Connection Failed. ${error.message}`, 'error');
                return false;
            }
        }

        async function generateView() {
            if (viewCount >= TOTAL_VIEWS) {
                updateStatus(`\nтЬЕ рд╕рд┐рдореБрд▓реЗрд╢рди рдкреВрд░рд╛ рд╣реБрдЖ! рдХреБрд▓ рд╕рдлрд▓ рд╡реНрдпреВрдЬрд╝: ${successfulViews}`, 'success');
                return;
            }

            viewCount++;
            const currentViewId = viewCount;
            const COUNTRY = getNextCountry(); 

            // 1. Session Start Event (рдирдпрд╛ User)
            await sendData('session_start', currentViewId, COUNTRY);
            
            // 2. Page View Event (рдирдпрд╛ View)
            await new Promise(resolve => setTimeout(resolve, 500)); 
            await sendData('page_view', currentViewId, COUNTRY);

            
            // 3. рдЕрдЧрд▓реЗ рд╡реНрдпреВ рдХреЗ рд▓рд┐рдП рджреЗрд░реА
            const delay = getRandomDelay();
            updateStatus(`[STATUS] View ${currentViewId} рдкреВрд░рд╛ рд╣реБрдЖред рджреЗрд╢: ${COUNTRY}. рдЕрдЧрд▓рд╛ рд╡реНрдпреВ ${Math.round(delay/1000)}s рдореЗрдВ...`);
            await new Promise(resolve => setTimeout(resolve, delay));
            
            generateView(); 
        }

        updateStatus(`ЁЯЪА рд╕рд┐рдореБрд▓реЗрд╢рди рд╢реБрд░реВ рд╣реЛ рд░рд╣рд╛ рд╣реИ. рд▓рдХреНрд╖реНрдп: ${TOTAL_VIEWS} рд╡реНрдпреВрдЬрд╝...`);
        generateView();
    </script>
</body>
</html>
