<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Website Traffic Simulator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f7f9fc;
      margin: 0; padding: 20px;
    }
    .card {
      background: white;
      max-width: 900px;
      margin: auto;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    h1 {
      text-align: center;
      color: #333;
    }
    .controls label {
      display: block;
      margin: 10px 0;
    }
    .controls input {
      padding: 6px;
      border-radius: 6px;
      border: 1px solid #ccc;
      min-width: 240px;
    }
    button {
      padding: 10px 16px;
      margin: 10px 5px 0 0;
      border: none;
      border-radius: 6px;
      background: #2563eb;
      color: white;
      cursor: pointer;
    }
    button:hover {
      background: #1e40af;
    }
    #log {
      background: #111;
      color: #0f0;
      font-family: monospace;
      font-size: 13px;
      padding: 10px;
      margin-top: 20px;
      border-radius: 8px;
      height: 250px;
      overflow-y: auto;
      white-space: pre-line;
    }
  </style>
</head>
<body>
  <div class="card">
    <h1>Website Traffic Simulator</h1>

    <div class="controls">
      <label>Website URL:
        <input id="simUrl" type="text" value="https://pooreyoutuber.github.io/">
      </label>
      <label>Duration (minutes):
        <input id="duration" type="number" value="5" min="1" max="60">
      </label>
      <label>Base Views per Minute:
        <input id="baseViews" type="number" value="200" min="10">
      </label>
    </div>

    <div>
      <button id="startBtn">Start Simulation</button>
      <button id="stopBtn">Stop</button>
      <button id="exportBtn">Export CSV</button>
    </div>

    <div id="log"></div>
  </div>

  <script>
    let state = {
      running: false,
      minute: 0,
      timer: null,
      data: []
    };

    const logEl = document.getElementById('log');
    const durationEl = document.getElementById('duration');
    const baseViewsEl = document.getElementById('baseViews');
    const simUrlEl = document.getElementById('simUrl');

    function log(msg){
      logEl.textContent = msg + "\\n" + logEl.textContent;
    }

    function startSimulation(){
      if(state.running) return;
      state.running = true;
      state.minute = 0;
      state.data = [];
      logEl.textContent = "";
      const duration = parseInt(durationEl.value);
      const baseViews = parseInt(baseViewsEl.value);

      log(`Simulation started for ${duration} minutes on ${simUrlEl.value}`);

      state.timer = setInterval(()=>{
        state.minute++;
        const views = Math.round(baseViews + (Math.random()-0.5)*50);
        const bounce = (30 + Math.random()*20).toFixed(1);
        const avgSession = (1 + Math.random()*3).toFixed(2);

        const record = {
          minute: state.minute,
          views, bounce, avgSession,
          site: simUrlEl.value
        };
        state.data.push(record);

        log(`Minute ${state.minute}: ${views} views | Bounce ${bounce}% | Avg. Session ${avgSession} min | Site: ${record.site}`);

        if(state.minute >= duration){
          stopSimulation();
          log("Simulation finished.");
        }
      }, 1000); // 1 second = 1 minute in demo
    }

    function stopSimulation(){
      clearInterval(state.timer);
      state.running = false;
    }

    function exportCSV(){
      if(state.data.length === 0){
        alert("No data to export!");
        return;
      }
      let csv = "minute,views,bounce,avgSession,site\\n";
      state.data.forEach(r=>{
        csv += `${r.minute},${r.views},${r.bounce},${r.avgSession},${r.site}\\n`;
      });
      const blob = new Blob([csv], {type:"text/csv"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "traffic_simulation.csv";
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
    }

    document.getElementById('startBtn').onclick = startSimulation;
    document.getElementById('stopBtn').onclick = stopSimulation;
    document.getElementById('exportBtn').onclick = exportCSV;
  </script>
</body>
</html>
