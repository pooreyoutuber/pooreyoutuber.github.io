<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>GA4 Traffic Injector (GitHub Pages)</title>
    
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding-top: 50px;
            background-color: #f4f4f4;
        }
        #status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            display: inline-block;
            text-align: left;
            min-width: 400px;
        }
        .success { color: green; font-weight: bold; }
        .error { color: red; font-weight: bold; }
    </style>
</head>
<body>

    <h1>GA4 ‡§ü‡•ç‡§∞‡•à‡§´‡§ø‡§ï ‡§∏‡§ø‡§Æ‡•Å‡§≤‡•á‡§∂‡§® (GitHub)</h1>
    <p>‡§≤‡§ï‡•ç‡§∑‡•ç‡§Ø: 250 ‡§µ‡•ç‡§Ø‡•Ç‡§ú‡§º ‡§î‡§∞ ‡§Ø‡•Ç‡§ú‡§º‡§∞‡•ç‡§∏</p>
    <div id="status">‡§∏‡§ø‡§Æ‡•Å‡§≤‡•á‡§∂‡§® ‡§∂‡•Å‡§∞‡•Ç ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</div>

    <script>
        // --- üéØ ‡§Ü‡§™‡§ï‡•Ä GA4 Keys (Measurement ID ‡§π‡•Ä ‡§ö‡§æ‡§π‡§ø‡§è) ---
        const MEASUREMENT_ID = 'G-ZPMC525FGT'; 
        // API_SECRET client-side code ‡§Æ‡•á‡§Ç ‡§ú‡§º‡§∞‡•Ç‡§∞‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à, ‡§á‡§∏‡§≤‡§ø‡§è ‡§π‡§Æ ‡§∏‡§ø‡§∞‡•ç‡§´‡§º Measurement ID ‡§ï‡§æ ‡§á‡§∏‡•ç‡§§‡•á‡§Æ‡§æ‡§≤ ‡§ï‡§∞‡•á‡§Ç‡§ó‡•á
        // ------------------------------------

        const TOTAL_VIEWS = 250; 
        const MIN_DELAY = 1500; // 1.5 seconds
        const MAX_DELAY = 4000; // 4 seconds

        // üéØ 15 ‡§¶‡•á‡§∂‡•ã‡§Ç ‡§ï‡•Ä ‡§∏‡•Ç‡§ö‡•Ä ‡§ú‡•ã Page Titles ‡§Æ‡•á‡§Ç ‡§¶‡§ø‡§ñ‡•á‡§ó‡•Ä
        const countries = [
            "Japan", "United States", "Germany", "Canada", "Netherlands", "India",
            "Brazil", "Mexico", "South Korea", "Australia", "Singapore", "France",
            "Spain", "Italy", "Turkey" 
        ]; 

        let successfulViews = 0;
        let viewCount = 0;
        let countryIndex = 0;
        // ‡§π‡§∞ ‡§¨‡§æ‡§∞ ‡§ú‡§¨ ‡§Ø‡§π ‡§™‡•á‡§ú ‡§≤‡•ã‡§° ‡§π‡•ã‡§ó‡§æ, ‡§§‡•ã ‡§è‡§ï ‡§®‡§Ø‡§æ client_id ‡§¨‡§®‡•á‡§ó‡§æ‡•§
        let clientId = Math.random().toString(36).substring(2, 12) + Date.now().toString(36); 

        const statusDiv = document.getElementById('status');
        
        function getNextCountry() {
            const country = countries[countryIndex % countries.length];
            countryIndex++;
            return country;
        }
        
        function updateStatus(message, className) {
            statusDiv.innerHTML = message;
            statusDiv.className = className || '';
        }

        function getRandomDelay() {
            return Math.random() * (MAX_DELAY - MIN_DELAY) + MIN_DELAY;
        }

        async function sendData(eventType, currentViewId, countryName) {
            // Measurement Protocol URL (Client-side tracking for page views)
            const GA_ENDPOINT = `https://www.google-analytics.com/mp/collect?measurement_id=${MEASUREMENT_ID}&api_secret=`; 
            
            const SESSION_ID = Date.now();
            const engagementTime = 10000 + Math.floor(Math.random() * 10000);
            
            const payload = {
                client_id: clientId,
                events: [{
                    name: eventType,
                    params: {
                        session_id: SESSION_ID,
                        page_location: window.location.href,
                        // üéØ Page Title ‡§Æ‡•á‡§Ç Country Trick
                        page_title: `PROJECT_VIEW_${currentViewId}_FROM_${countryName}`, 
                        engagement_time_msec: engagementTime,
                        _ss: eventType === 'session_start' ? 1 : undefined,
                        debug_mode: true
                    }
                }]
            };

            try {
                // Fetch call to Google Analytics
                const response = await fetch(GA_ENDPOINT, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload),
                    mode: 'no-cors' // This is necessary for client-side JavaScript to bypass CORS issues
                });

                // Client-side MP calls return 'opaque' response in no-cors mode, which is usually a success.
                if (response.status === 204 || response.type === 'opaque') {
                    if (eventType === 'page_view') {
                        successfulViews++;
                        updateStatus(`[SUCCESS] View ${currentViewId}: page_view ‡§≠‡•á‡§ú‡§æ ‡§ó‡§Ø‡§æ‡•§ ‡§¶‡•á‡§∂: ${countryName}. ‡§ï‡•Å‡§≤ ‡§∏‡§´‡§≤‡§§‡§æ: ${successfulViews}`, 'success');
                    }
                    return true;
                } else {
                    updateStatus(`[FAILURE] View ${currentViewId}: Status ${response.status}.`, 'error');
                    return false;
                }
            } catch (error) {
                updateStatus(`[ERROR] View ${currentViewId}: Connection Failed. ${error.message}`, 'error');
                return false;
            }
        }

        async function generateView() {
            if (viewCount >= TOTAL_VIEWS) {
                updateStatus(`\n‚úÖ ‡§∏‡§ø‡§Æ‡•Å‡§≤‡•á‡§∂‡§® ‡§™‡•Ç‡§∞‡§æ ‡§π‡•Å‡§Ü! ‡§ï‡•Å‡§≤ ‡§∏‡§´‡§≤ ‡§µ‡•ç‡§Ø‡•Ç‡§ú‡§º: ${successfulViews}`, 'success');
                return;
            }

            viewCount++;
            const currentViewId = viewCount;
            const COUNTRY = getNextCountry(); 

            // 1. Session Start Event (‡§Ø‡§π ‡§®‡§Ø‡§æ User ‡§¨‡§®‡§æ‡§è‡§ó‡§æ)
            await sendData('session_start', currentViewId, COUNTRY);
            
            // 2. Page View Event (‡§Ø‡§π ‡§®‡§Ø‡§æ View ‡§¨‡§®‡§æ‡§è‡§ó‡§æ)
            await new Promise(resolve => setTimeout(resolve, 500)); 
            await sendData('page_view', currentViewId, COUNTRY);

            
            // 3. ‡§Ö‡§ó‡§≤‡•á ‡§µ‡•ç‡§Ø‡•Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§¶‡•á‡§∞‡•Ä
            const delay = getRandomDelay();
            updateStatus(`[STATUS] View ${currentViewId} ‡§™‡•Ç‡§∞‡§æ ‡§π‡•Å‡§Ü‡•§ ‡§¶‡•á‡§∂: ${COUNTRY}. ‡§Ö‡§ó‡§≤‡§æ ‡§µ‡•ç‡§Ø‡•Ç ${Math.round(delay/1000)}s ‡§Æ‡•á‡§Ç...`);
            await new Promise(resolve => setTimeout(resolve, delay));
            
            // Re-run the function recursively
            generateView(); 
        }

        updateStatus(`üöÄ ‡§∏‡§ø‡§Æ‡•Å‡§≤‡•á‡§∂‡§® ‡§∂‡•Å‡§∞‡•Ç ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à. ‡§≤‡§ï‡•ç‡§∑‡•ç‡§Ø: ${TOTAL_VIEWS} ‡§µ‡•ç‡§Ø‡•Ç‡§ú‡§º...`);
        // Start the process
        generateView();
    </script>
</body>
</html>
