<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåê 10x Multi-Viewer Browser</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* General Setup & Global Controls (Unchanged) */
        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f2f5; 
            color: #1d2129;
            overflow-x: hidden;
        }
        h1 {
            color: #1877f2; 
            text-align: center;
            padding: 20px 0;
            background-color: #ffffff;
            margin: 0 0 25px 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            font-weight: 700;
            letter-spacing: 1px;
        }
        .global-controls {
            max-width: 95%;
            margin: 0 auto 30px auto;
            background-color: #ffffff;
            padding: 20px 30px;
            border-radius: 12px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
            border-left: 5px solid #1877f2;
        }

        /* Global URL Input Section (Unchanged) */
        .url-input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        .url-input-group input[type="url"] {
            flex-grow: 1;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        .url-input-group input[type="url"]:focus {
            border-color: #1877f2;
            outline: none;
        }
        .url-input-group button {
            padding: 10px 25px;
            background-color: #42b72a; 
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: background-color 0.3s, transform 0.2s;
        }
        .url-input-group button:hover {
            background-color: #36a420;
            transform: translateY(-1px);
        }

        /* Global Options (Unchanged) */
        .options-group {
            display: flex;
            justify-content: flex-start;
            gap: 30px;
            padding-top: 15px;
            border-top: 1px solid #eee;
        }
        .option-item {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-size: 15px;
        }
        .option-item input[type="checkbox"] {
            margin-right: 10px;
            appearance: none;
            width: 20px;
            height: 20px;
            border: 2px solid #1877f2;
            border-radius: 4px;
            position: relative;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .option-item input[type="checkbox"]:checked {
            background-color: #1877f2;
        }
        .option-item input[type="checkbox"]:checked::after {
            content: '‚úì';
            position: absolute;
            top: 0px;
            left: 3px;
            color: white;
            font-size: 14px;
            font-weight: bold;
        }

        /* Iframe Grid Styling (Unchanged) */
        .iframe-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr); 
            gap: 20px;
            max-width: 95%;
            margin: 0 auto;
            min-height: 80vh; 
            padding-bottom: 20px;
        }
        
        #slot-10 {
            grid-column: 1 / span 3; 
            height: 400px; 
        }
        
        .iframe-slot {
            border: 1px solid #c0ccda;
            border-radius: 10px;
            background-color: #fff;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08);
            display: flex;
            flex-direction: column;
            overflow: hidden; 
            transition: transform 0.3s;
            height: 350px; 
        }
        .iframe-slot:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
        }

        .slot-header {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 8px;
            background-color: #e5f0ff; 
            color: #1877f2;
            font-weight: 600;
            font-size: 14px;
            flex-shrink: 0;
            border-bottom: 1px solid #c0ccda;
        }
        
        /* Iframe Container & Scaling - IMPROVED FOR SCROLLING */
        .iframe-container {
            flex-grow: 1;
            position: relative;
            /* Enable scrolling on the container to move the viewable area */
            overflow-y: scroll; 
        }
        .iframe-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 1280px; 
            /* Set a fixed height that is larger than the container's visible area */
            height: 1500px; 
            min-height: 1500px; /* Ensures a long virtual page */
            border: none;
            
            /* The scale value must ensure the height fits within the container's scroll area */
            transform: scale(0.35); 
            transform-origin: 0 0; 
        }
    </style>
</head>
<body>

    <h1>üåé 10x Multi-Viewer Browser (3x3 + 1 Layout)</h1>

    <div class="global-controls">
        <p style="font-weight: bold; margin-bottom: 10px; color: #1877f2; font-size: 18px;">üîó Global URL Load (Loads the URL into all 10 slots):</p>
        <div class="url-input-group">
            <input type="url" id="globalUrlInput" placeholder="https://example.com or example.com" value="google.com">
            <button id="loadAllButton" onclick="loadAllUrls()">üöÄ Go & Load All</button>
        </div>
        
        <p style="font-weight: bold; margin-bottom: 5px; color: #1d2129; border-top: 1px solid #eee; padding-top: 15px;">‚öôÔ∏è Global Options:</p>
        <div class="options-group">
            <label class="option-item" for="autoReloadCheckbox">
                <input type="checkbox" id="autoReloadCheckbox">
                üîÑ Auto Reload (Every 30s)
            </label>
            <label class="option-item" for="autoScrollCheckbox">
                <input type="checkbox" id="autoScrollCheckbox">
                ‚¨áÔ∏è Auto Scrolling (30s Cycle)
            </label>
        </div>
    </div>

    <div class="iframe-grid" id="iframeContainer">
    </div>

    <script>
        const container = document.getElementById('iframeContainer');
        const globalUrlInput = document.getElementById('globalUrlInput');
        const autoReloadCheckbox = document.getElementById('autoReloadCheckbox');
        const autoScrollCheckbox = document.getElementById('autoScrollCheckbox');
        
        const NUM_SLOTS = 10;
        let reloadInterval = null;
        let scrollInterval = null;
        
        const slotUrls = Array(NUM_SLOTS).fill('about:blank');

        // 1. Initial Setup: Create 10 Mini-Browser Slots
        function initializeSlots() {
            for (let i = 0; i < NUM_SLOTS; i++) {
                const slotDiv = document.createElement('div');
                slotDiv.className = 'iframe-slot';
                slotDiv.id = `slot-${i + 1}`; 

                const header = document.createElement('div');
                header.className = 'slot-header';
                header.textContent = `Slot ${i + 1}`;
                slotDiv.appendChild(header);

                const iframeContainer = document.createElement('div');
                iframeContainer.className = 'iframe-container';
                iframeContainer.id = `iframeContainer-${i + 1}`;
                
                const iframe = document.createElement('iframe');
                iframe.id = `iframe-${i + 1}`;
                iframe.src = slotUrls[i]; 
                
                iframeContainer.appendChild(iframe);
                slotDiv.appendChild(iframeContainer);

                container.appendChild(slotDiv);
            }
        }

        // 2. Load URL in all slots
        function loadAllUrls() {
            const url = globalUrlInput.value.trim();

            if (!url) {
                alert(`Please enter a valid URL!`);
                globalUrlInput.focus();
                return;
            }

            // Ensure protocol is present
            const fullUrl = url.startsWith('http') ? url : `https://${url}`;
            slotUrls.fill(fullUrl); 

            // Load the URL in all 10 iframes
            for (let i = 1; i <= NUM_SLOTS; i++) {
                const iframe = document.getElementById(`iframe-${i}`);
                if (iframe) {
                    // Check if the source is the same, if so, force reload to reset scrolling
                    if (iframe.src === fullUrl) {
                         iframe.contentWindow.location.reload(true);
                    } else {
                        iframe.src = fullUrl;
                    }
                }
            }
            console.log(`Loaded URL: ${fullUrl} into all ${NUM_SLOTS} slots.`);
        }
        
        // Add Enter key listener for the global input field
        globalUrlInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                loadAllUrls();
            }
        });

        // 3. Auto Reload Management
        function manageAutoReload() {
            if (reloadInterval) {
                clearInterval(reloadInterval);
                reloadInterval = null;
            }

            if (autoReloadCheckbox.checked) {
                reloadInterval = setInterval(() => {
                    for (let i = 1; i <= NUM_SLOTS; i++) {
                        const url = slotUrls[i - 1];
                        if (url && url !== 'about:blank') {
                            const iframe = document.getElementById(`iframe-${i}`);
                            if (iframe && iframe.contentWindow) {
                                // Reload using contentWindow to force a fresh page load
                                iframe.contentWindow.location.reload(true);
                            }
                        }
                    }
                    console.log(`Auto Reloaded ${NUM_SLOTS} slots.`);
                }, 30000); 
            }
        }

        // 4. Auto Scrolling Management - FIX APPLIED HERE
        function manageAutoScroll() {
            if (scrollInterval) {
                clearInterval(scrollInterval);
                scrollInterval = null;
            }

            if (autoScrollCheckbox.checked) {
                let scrollStep = 0;
                const NUM_STEPS = 10;
                const CYCLE_TIME_SECONDS = 30;
                // Calculate interval duration to complete the steps in CYCLE_TIME_SECONDS
                const INTERVAL_MS = (CYCLE_TIME_SECONDS * 1000) / NUM_STEPS; 

                scrollInterval = setInterval(() => {
                    // Cycle steps from 1 to 10
                    scrollStep = (scrollStep % NUM_STEPS) + 1; 

                    for (let i = 1; i <= NUM_SLOTS; i++) {
                        const iframeContainer = document.getElementById(`iframeContainer-${i}`);
                        
                        if (iframeContainer) {
                            // Calculate the total scrollable height
                            const maxScroll = iframeContainer.scrollHeight - iframeContainer.clientHeight;
                            
                            // Determine the scroll amount per step
                            const SCROLL_AMOUNT_PER_STEP = maxScroll / (NUM_STEPS - 1); 
                            
                            let targetScrollTop = SCROLL_AMOUNT_PER_STEP * (scrollStep - 1);
                            
                            if (scrollStep === 1) {
                                targetScrollTop = 0; // Ensure reset to top on the first step
                            }
                            
                            // Apply the smooth scroll to the IFRAME CONTAINER DIV
                            iframeContainer.scrollTo({
                                top: targetScrollTop,
                                behavior: 'smooth'
                            });
                        }
                    }
                    console.log(`Scrolling Step: ${scrollStep}`);

                }, INTERVAL_MS); 
            }
        }

        // --- Event Listeners ---
        autoReloadCheckbox.addEventListener('change', manageAutoReload);
        autoScrollCheckbox.addEventListener('change', manageAutoScroll);

        // Initialize the tool
        initializeSlots();
    </script>

</body>
</html>
