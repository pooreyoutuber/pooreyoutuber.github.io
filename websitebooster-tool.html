<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SMM AUTOPILOT COCKPIT | LIVE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body { background: #020617; color: #f1f5f9; font-family: sans-serif; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
        .glass { background: rgba(15, 23, 42, 0.9); backdrop-filter: blur(10px); border: 1px solid #1e293b; }
        /* Badi Live Window */
        .live-window-container { flex: 1; position: relative; background: #000; border: 4px solid #1e293b; border-radius: 15px; margin: 10px; overflow: hidden; display: flex; align-items: center; justify-content: center; }
        #streamImg { max-width: 100%; max-height: 100%; object-fit: contain; }
        .hud-overlay { position: absolute; top: 10px; left: 10px; background: rgba(220, 38, 38, 0.8); color: white; padding: 4px 10px; border-radius: 5px; font-size: 12px; font-weight: bold; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }
        .side-panel { width: 350px; padding: 15px; display: flex; flex-direction: column; gap: 15px; }
        input, button { width: 100%; border-radius: 10px; }
    </style>
</head>
<body>

    <header class="glass p-3 flex justify-between items-center mx-2 mt-2 rounded-xl">
        <div class="flex items-center gap-2">
            <i class="fa-solid fa-plane-up text-blue-500 text-xl"></i>
            <h1 class="font-black text-lg tracking-tight uppercase italic">Autopilot <span class="text-blue-500">Live</span></h1>
        </div>
        <div id="status" class="text-[10px] font-bold px-3 py-1 rounded-full bg-red-900/50 text-red-500 border border-red-500">ENGINE OFFLINE</div>
    </header>

    <div class="flex flex-1 overflow-hidden">
        <div class="live-window-container shadow-2xl">
            <div class="hud-overlay">LIVE FEED FROM SERVER</div>
            <img id="streamImg" src="https://via.placeholder.com/1280x720?text=CLICK+LAUNCH+ENGINE+TO+START+LIVE+FEED" alt="Virtual Browser Stream">
        </div>

        <div class="side-panel glass m-2 rounded-2xl">
            <div>
                <label class="text-[10px] font-bold text-slate-500 uppercase">Step 1: Start System</label>
                <button onclick="launchEngine()" id="lchBtn" class="mt-2 bg-blue-600 hover:bg-blue-500 text-white font-bold py-4 transition-all">LAUNCH ENGINE üöÄ</button>
            </div>

            <hr class="border-slate-800">

            <div class="space-y-4">
                <label class="text-[10px] font-bold text-slate-500 uppercase">Step 2: Mission Config</label>
                <input type="text" id="cUrl" placeholder="YouTube Channel Link" class="bg-slate-950 border border-slate-800 p-4 text-sm outline-none focus:border-blue-500 transition-all">
                
                <div class="grid grid-cols-2 gap-2">
                    <input type="number" id="vQty" placeholder="Views" class="bg-slate-950 border border-slate-800 p-4 text-sm outline-none">
                    <input type="number" id="tTime" placeholder="Secs" class="bg-slate-950 border border-slate-800 p-4 text-sm outline-none">
                </div>

                <button onclick="startMission()" id="msnBtn" class="bg-slate-800 text-slate-500 font-bold py-4 cursor-not-allowed" disabled>ENGAGE AUTOPILOT ‚úàÔ∏è</button>
            </div>

            <div id="logs" class="flex-1 bg-black/50 rounded-xl p-3 font-mono text-[10px] text-slate-400 overflow-y-auto mt-2">
                > System Standby...
            </div>
        </div>
    </div>

    <script>
        // HARDCODED RENDER URL - AB YE REQUEST ISI PAR JAYEGI
        const RENDER_URL = "https://pooreyoutuber-github-ioproxy.onrender.com"; 

        const stream = document.getElementById('streamImg');
        const logBox = document.getElementById('logs');
        const lchBtn = document.getElementById('lchBtn');
        const msnBtn = document.getElementById('msnBtn');

        function addLog(msg) {
            const d = document.createElement('div');
            d.innerHTML = `<span class="text-blue-500">[${new Date().toLocaleTimeString()}]</span> > ${msg}`;
            logBox.prepend(d);
        }

        async function launchEngine() {
            addLog("Connecting to: " + RENDER_URL);
            lchBtn.innerText = "POWERING UP...";
            
            try {
                // Requesting your server to open browser
                const res = await fetch(`${RENDER_URL}/api/init-engine`);
                const data = await res.json();
                
                if(data.status) {
                    addLog("Engine Online! Displaying Live Feed.");
                    document.getElementById('status').innerText = "ENGINE ONLINE";
                    document.getElementById('status').className = "text-[10px] font-bold px-3 py-1 rounded-full bg-green-900/50 text-green-400 border border-green-500";
                    
                    lchBtn.innerText = "ENGINE READY ‚úÖ";
                    lchBtn.disabled = true;
                    msnBtn.disabled = false;
                    msnBtn.className = "bg-orange-600 hover:bg-orange-500 text-white font-bold py-4 transition-all";
                    
                    // Live Streaming logic - Refresh image every second
                    setInterval(() => {
                        stream.src = `${RENDER_URL}/live-check?t=` + new Date().getTime();
                    }, 1000);
                }
            } catch (e) {
                addLog("Error: Server not responding. Is Render App Sleeping?");
                lchBtn.innerText = "RETRY LAUNCH";
            }
        }

        async function startMission() {
            const url = document.getElementById('cUrl').value;
            const views = document.getElementById('vQty').value;
            const time = document.getElementById('tTime').value;

            if(!url || !views || !time) return alert("Fill all details!");

            addLog("Mission Data Dispatched. Autopilot Engaged.");
            msnBtn.innerText = "MISSION ACTIVE ‚úàÔ∏è";
            msnBtn.disabled = true;

            try {
                await fetch(`${RENDER_URL}/api/channel-grow-boost`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        channel_url: url,
                        views_count: views,
                        watch_time: time
                    })
                });
                addLog("System Status: Binge Watching mode active.");
            } catch (err) {
                addLog("Mission Failed to send.");
            }
        }
    </script>
</body>
</html>
