<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>1. Article Submission Tool | PooreYouTuber</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style> /* ... (Your CSS from the previous response goes here for brevity) ... */ </style>
</head>
<body>
    <div class="container">
        <h1>üñäÔ∏è Article Submission Tool (Permanent Server Storage)</h1>
        <div class="disclaimer">
            **IMPORTANT NOTICE:** Articles are saved **permanently on the server** (File System). Clear history will NOT lose data. Use the Delete Key carefully.
        </div>
        <form id="article-form">
            <h2>Submit Your Article</h2>
            <div class="form-group">
                <label for="author-name">Your Name (Author)</label>
                <input type="text" id="author-name" placeholder="E.g., PooreYouTuber Fan" required>
            </div>
            <div class="form-group">
                <label for="article-title">Article Title</label>
                <input type="text" id="article-title" required>
            </div>
            <div class="form-group">
                <label for="article-content">Article Content</label>
                <textarea id="article-content" required></textarea>
            </div>
            <button type="submit">Publish Article</button>
        </form>

        <div id="article-list-container">
            <h2>Latest Articles (Server)</h2>
            <div id="articles-list">
                <p id="no-articles-msg">Loading articles...</p>
            </div>
        </div>
    </div>

    <script>
        // ‚≠ê API URL for Article Tool ‚≠ê
        const API_URL = "https://pooreyoutuber-github-io.onrender.com/api/articles"; 
        const articleForm = document.getElementById('article-form');
        const articlesListDiv = document.getElementById('articles-list');

        // --- CORE FUNCTIONS ---
        async function fetchArticles() {
            try {
                const response = await fetch(API_URL);
                return response.ok ? await response.json() : [];
            } catch (error) { return []; }
        }

        async function postArticle(articleData) {
            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(articleData)
                });
                if (!response.ok) throw new Error('Failed to publish article');
                return true;
            } catch (error) {
                alert(`Error publishing article: ${error.message}`);
                return false;
            }
        }
        
        async function deleteArticle(articleId) {
            const deleteKey = prompt("‚ö†Ô∏è CONFIRM DELETE: Enter Owner Delete Key:");
            if (!deleteKey) return;
            
            try {
                const response = await fetch(`${API_URL}/${articleId}`, {
                    method: 'DELETE',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ deleteKey: deleteKey })
                });

                const result = await response.json();
                alert(response.ok ? result.message : `Deletion Failed: ${result.message}`);
                if (response.ok) renderArticles();

            } catch (error) {
                alert(`Network Error during deletion: ${error.message}`);
            }
        }

        function renderArticles() {
            articlesListDiv.innerHTML = '<p id="no-articles-msg">Loading articles...</p>';
            fetchArticles().then(articles => {
                articlesListDiv.innerHTML = ''; 
                if (articles.length === 0) {
                    articlesListDiv.innerHTML = '<p id="no-articles-msg">No articles found on the server. Submit one!</p>';
                    return;
                }

                articles.forEach((article, index) => {
                    // ... (Card HTML generation using article data and deleteArticle function) ...
                    const articleCard = document.createElement('div');
                    articleCard.className = 'article-card';
                    const date = new Date(article.timestamp).toLocaleString();
                    articleCard.innerHTML = `
                        <div class="article-number">#${index + 1}</div>
                        <div class="article-content-wrapper">
                            <h3>${article.title}</h3>
                            <div class="article-meta">
                                By: <strong>${article.author || 'Anonymous'}</strong> | Published: ${date}
                            </div>
                            <p>${article.content}</p>
                            <div class="article-actions">
                                <button class="action-button delete-button" onclick="deleteArticle('${article.id}')">
                                    <i class="fas fa-trash-alt"></i> Delete
                                </button>
                            </div>
                        </div>
                    `;
                    articlesListDiv.appendChild(articleCard);
                });
            });
        }

        articleForm.addEventListener('submit', async function(e) {
            e.preventDefault(); 
            const author = document.getElementById('author-name').value.trim();
            const title = document.getElementById('article-title').value.trim();
            const content = document.getElementById('article-content').value.trim();

            if (await postArticle({ author, title, content })) {
                articleForm.reset();
                renderArticles();
                alert('Article Published Successfully on Server!');
            }
        });

        document.addEventListener('DOMContentLoaded', () => {
             // applySavedTheme(); // Theme function here if you included the CSS
             renderArticles();
        });
        
        window.deleteArticle = deleteArticle; // Make function globally accessible
    </script>
</body>
</html>
