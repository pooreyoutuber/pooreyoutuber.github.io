<?php
// PHP error reporting рдмрдВрдж рдХрд░реЗрдВ (рд╕реБрд░рдХреНрд╖рд╛ рдФрд░ рдХреНрд▓реАрди рдЖрдЙрдЯрдкреБрдЯ рдХреЗ рд▓рд┐рдП)
error_reporting(0);

// ====================================================
// ЁЯФТ рдЖрдкрдХреА Webshare рдкреНрд░реЙрдХреНрд╕реА рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ ЁЯФТ
// ====================================================
// Webshare рдХрд╛ Domain/IP
$proxyHost = 'p.webshare.io'; 
// Webshare рдХрд╛ рдкреЛрд░реНрдЯ
$proxyPort = '80'; 
// Webshare рдкреНрд░реЙрдХреНрд╕реА рдпреВрдЬрд╝рд░рдиреЗрдо (Rotating Pool)
$proxyUsername = 'bqctypvz-rotate'; 
// Webshare рдкреНрд░реЙрдХреНрд╕реА рдкрд╛рд╕рд╡рд░реНрдб
$proxyPassword = '399xb3kxqv6i'; 
// ====================================================


// рдпреВрдЬрд╝рд░ рджреНрд╡рд╛рд░рд╛ рдбрд╛рд▓рд╛ рдЧрдпрд╛ URL рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
$targetUrl = isset($_GET['url']) ? $_GET['url'] : '';

if (empty($targetUrl)) {
    // рдЕрдЧрд░ iframe рдореЗрдВ рдХреЛрдИ URL рдирд╣реАрдВ рд╣реИ, рддреЛ рдЦрд╛рд▓реА рд░рдЦреЗрдВ
    exit; 
}

// URL рдХреЛ рд╕реИрдирд┐рдЯрд╛рдЗрдЬ рдХрд░реЗрдВ рдФрд░ 'http://' рдпрд╛ 'https://' рдЬреЛрдбрд╝реЗрдВ рдпрджрд┐ missing рд╣реЛ
if (substr($targetUrl, 0, 4) !== 'http') {
    $targetUrl = 'http://' . $targetUrl;
}

// cURL initialization
$ch = curl_init();

// cURL рдСрдкреНрд╢рдиреНрд╕ рд╕реЗрдЯ рдХрд░реЗрдВ
curl_setopt($ch, CURLOPT_URL, $targetUrl);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); 
curl_setopt($ch, CURLOPT_HEADER, false); 
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true); 
curl_setopt($ch, CURLOPT_TIMEOUT, 30); 
// HTTPS рд╕рд╛рдЗрдЯреНрд╕ рдХреЗ рд▓рд┐рдП SSL verification рдХреЛ рдмрдВрдж рдХрд░реЗрдВ (рдЯреЗрд╕реНрдЯрд┐рдВрдЧ/рдХреЙрд▓реЗрдЬ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХреЗ рд▓рд┐рдП)
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false); 
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false);

// ----------------------------------------------------
// Webshare рдкреНрд░реЙрдХреНрд╕реА рд╕реЗрдЯрд┐рдВрдЧреНрд╕
// ----------------------------------------------------
// рдкреНрд░реЙрдХреНрд╕реА IP рдФрд░ рдкреЛрд░реНрдЯ рд╕реЗрдЯ рдХрд░реЗрдВ
curl_setopt($ch, CURLOPT_PROXY, "$proxyHost:$proxyPort");

// рдкреНрд░реЙрдХреНрд╕реА Authentication (рдпреВрдЬрд╝рд░рдиреЗрдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб) рд╕реЗрдЯ рдХрд░реЗрдВ
$auth = "$proxyUsername:$proxyPassword";
curl_setopt($ch, CURLOPT_PROXYUSERPWD, $auth);
curl_setopt($ch, CURLOPT_PROXYAUTH, CURLAUTH_BASIC);
// ----------------------------------------------------

// URL рдХреЛ рдлреЗрдЪ рдХрд░реЗрдВ
$response = curl_exec($ch);
$error = curl_error($ch);
$httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);

curl_close($ch);

// рддреНрд░реБрдЯрд┐ рдХреА рдЬрд╛рдБрдЪ рдФрд░ рдЖрдЙрдЯрдкреБрдЯ
if ($error) {
    echo "<h2 style='color:red;'>тЭМ рдкреНрд░реЙрдХреНрд╕реА рдХрдиреЗрдХреНрд╢рди/cURL рддреНрд░реБрдЯрд┐:</h2>";
    echo "<p>Error: " . htmlspecialchars($error) . "</p>";
    echo "<p><strong>рдХреГрдкрдпрд╛ рдЬрд╛рдБрдЪ рдХрд░реЗрдВ:</strong> 1. Webshare рдкреНрд░реЙрдХреНрд╕реА рдПрдХреНрдЯрд┐рд╡ рд╣реИред 2. рдпрд╣ рдХреЛрдб XAMPP/рд╡реЗрдм рд╕рд░реНрд╡рд░ рдкрд░ рдЪрд▓ рд░рд╣рд╛ рд╣реИред</p>";
} elseif ($httpCode >= 400) {
    echo "<h2 style='color:orange;'>тЭМ HTTP рддреНрд░реБрдЯрд┐ $httpCode</h2>";
    echo "<p>рд╡реЗрдмрд╕рд╛рдЗрдЯ рд▓реЛрдб рдирд╣реАрдВ рд╣реЛ рдкрд╛рдИ рдпрд╛ Webshare рдиреЗ рдЕрдиреБрд░реЛрдз рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд░ рджрд┐рдпрд╛ред (рд╣реЛрд╕реНрдЯрд┐рдВрдЧ, рдпрд╛ рдкреНрд░реЙрдХреНрд╕реА рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ)</p>";
} else {
    // Geo-location Spoofing:
    // рд╡реЗрдмрд╕рд╛рдЗрдЯ рдЕрдм рдкреНрд░реЙрдХреНрд╕реА IP рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд▓реЛрдб рд╣реБрдИ рд╣реИ, рдФрд░ рдЙрд╕рдХрд╛ Google Analytics 
    // рдЯреНрд░реИрдХрд┐рдВрдЧ рдХреЛрдб рдкреНрд░реЙрдХреНрд╕реА рд╕рд░реНрд╡рд░ рдХреЗ Geo-location рдХреЛ рд░рд┐рдХреЙрд░реНрдб рдХрд░реЗрдЧрд╛ред
    
    // рдХрдВрдЯреЗрдВрдЯ рдХреЛ рдЖрдЙрдЯрдкреБрдЯ рдХрд░реЗрдВ (рдмрд┐рдирд╛ URL Rewriting рдХреЗ)
    echo $response;
}
?>
